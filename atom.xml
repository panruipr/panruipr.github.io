<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ThrowsException的个人博客</title>
  <icon>https://www.gravatar.com/avatar/5609bc06c51c9009d04648504ea05dba</icon>
  <subtitle>Work And Life,Code And Book</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://panruipr.github.io/"/>
  <updated>2018-11-21T10:53:31.897Z</updated>
  <id>https://panruipr.github.io/</id>
  
  <author>
    <name>rui Pan</name>
    <email>panrui1993616@gmail.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="https://panruipr.github.io/2018/11/21/rebbit/"/>
    <id>https://panruipr.github.io/2018/11/21/rebbit/</id>
    <published>2018-11-21T10:53:31.933Z</published>
    <updated>2018-11-21T10:53:31.897Z</updated>
    
    <content type="html"><![CDATA[<p>“咳…咳咳..咳”,小兔子捂着胸口剧烈地咳嗽着，好一会才稍微缓过气来，难不成溺死的鬼会咳嗽？</p><p>小兔子放下爪子，一圈涟漪荡漾开来，吓得她倒退几步，又几圈显得杂乱无章的涟漪扩散开来，小兔子惊奇的发现自己居然站在水面上，脚下还有另一只兔子，水汪汪的眼睛，白绒绒的皮毛，头顶还有一座七彩拱桥。居然把桥修在水里，是脑子被胡萝卜吃了？还是胡萝卜把脑子吃了？，不过，七彩缤纷的颜色，还真是耀眼呢！</p><p>“你好啊，小白兔！”，一道温润如水的声音响起，打断了小兔子的思绪；</p><p>”谁？在哪里？是在叫我吗？“，小兔子慌乱地扭头观察四周，也没发现谁在说话。(萌新三连击！！)</p><p>“呵呵，你再仔细看看。我就在你眼前啊”。</p><p>“请问，你是住在水里的么？”，小兔子惊奇的发现那座漂亮的桥正对着自己微笑，却还是有些惊疑不定。</p><p>“哈哈，你怎么跑到这里来了？“又是一阵笑声传来。</p><p>”对了，我是来找彩虹的，您知道彩虹住在哪里么？“，被这么一问，小兔子才想起自己此行的目的。小心翼翼的问道。</p><p>”嗯…我知道彩虹住在哪里，但是想要过去却并不简单“，桥似乎有些迟疑，思索了一会才回答。</p><p>”那您可以带我去么？不管怎样我都愿意！！“。小兔子顿时急切了起来</p><p>”就算是我也不能带你过去，但是我有方法让你过去！“</p><pre><code>”真的吗？请您告诉我见到彩虹的方法“，小兔子言辞恳切，欣喜无比。这下总算是有希望了”好吧...你可要准备好了“只见七彩桥的颜色开始剧烈的晃动起来，像是要坍塌一般，七种颜色从桥上蔓延开来，眨眼整个湖水都被浸染成七彩的，紧接着湖面也开始晃动，”噗通“一声，小兔子又跌落到湖里，她慌乱的挥舞着四肢，好一会才发现，那让人窒息的寒冷与黑暗并没有出现，大片大片七色的光包裹着她，竟然有些温暖。                                part1 流星小兔子只记得一阵天旋地转，再睁开眼就出现在这里，入眼都是暗紫色的星云，远远看去还有一颗颗星星镶嵌在其中。一闪一闪的。”哇哦，好美的景色“，小兔子一边惊呼，一边划动四肢，像是游泳一般。身下是一条波光璀璨的银河，弯弯曲曲，随着目光的延伸逐渐掩没在星云里。仿佛没有镜头，横贯在无边无际的宇宙。说好的方法呢？难不成彩虹住在银河的尽头？喂，滴滴客服么，我要滴滴打船...错,是宇宙飞船！”好累啊！不想动！明明是河，为什么没有浪，毕竟我的兔生不划浆，全靠浪...“，小兔子趴在悬浮的碎石上，有气无力的划动着四肢。”此山是我开，此树是我栽...咦，不对，咳咳...此石是我采...”，一道略显中气不足的声音传来。小白兔遁着声音望去，一只洁白如玉的红眼兔子不知何时出现在她前方的一颗碎石上，一爪指天，一爪指地，浑身散发出天上地下，唯我独尊的霸气。连忙道：”英雄，是你吗？“红眼兔子略显尴尬，随即脸色一正，朗声道：”已经没事了，要问为什么？因为我来了。“</code></pre><p>“阿基米德，快看，有流星哎，是谁把天上的星星撬下来了吗？”小男孩兴奋的手舞足蹈，拽着阿基米德的袖子，指着天空中银白的光芒兴奋的嚷嚷道。</p><p>”哼~，给我个支点，我将撬动地球”，阿基米德放下手中的撬棍，毫不犹豫的说道.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;“咳…咳咳..咳”,小兔子捂着胸口剧烈地咳嗽着，好一会才稍微缓过气来，难不成溺死的鬼会咳嗽？&lt;/p&gt;
&lt;p&gt;小兔子放下爪子，一圈涟漪荡漾开来，吓得她倒退几步，又几圈显得杂乱无章的涟漪扩散开来，小兔子惊奇的发现自己居然站在水面上，脚下还有另一只兔子，水汪汪的眼睛，白绒绒的皮毛
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>此生相遇，便是团圆</title>
    <link href="https://panruipr.github.io/2018/11/05/meet-reunion/"/>
    <id>https://panruipr.github.io/2018/11/05/meet-reunion/</id>
    <published>2018-11-05T01:25:29.000Z</published>
    <updated>2018-11-05T01:30:14.956Z</updated>
    
    <content type="html"><![CDATA[<p>此生相遇，便是团圆。</p><p>这是她的微信签名，此时遇见的不是我，我们相遇是在曾经。如今，我只不过是她前半生的过客，甚至连过客都不如了吧。</p><p>回头看看，暮然惊觉，第一次与她相遇竟是在酒年前。时间还真是一把杀猪刀，不知不觉就屠宰了青春，九年里，读完了高中，上完了大学，褪去了纯真，养肥了肚腩。我与她兜兜转转，杂乱的曲线终将是走成两条平行线。我是该悲伤，该追悔，还是该平淡？她领证了，法律意义上已经结婚了，我是该祝福，该失落，还是该默默不语？早已预见的结局发生在眼前，竟然这么无趣。”你信命中注定吗？“，我还是不信呢！</p><p>九年前她是这么问我的，我是这么回答的。她说我是她命中注定遇见的人，我想她说这句的的时候一定是欣喜的。她说是我曾给了她勇气去抵御自卑带来的恐惧。可我也让她重新跌进这看不到底的深渊里，打破了她曾经的梦想。哪有什么命中注定，与她而言怕不是事事无常？或许是命中注定此生相遇，只是没有团圆。我问不了她，她把我拉黑前对我说就当她死了。</p><p>说的这么难听，一定对我恨之入骨。我们分手的时候她跑过来找我，走的时候雨刚停，塞给我一把伞。就这样散了，听说她喝酒喝到很晚。一醉解千愁？她也没能如愿。她恨我她总说感谢我让她成长，她不幸福却总说她过的比我好。她闺蜜说我无情无义骂我渣男，她问我为什么分手有没有喜欢过她，我问自己有没有后悔。说不后悔那是自欺欺人，只是不知不觉越走越远。她坚强善良，虚寒问暖，无微不至。对我比对她自己好，我理因感到荣幸，可却感到异常沉重，不堪负重。后来我没有回头，她没有再开口挽留。她和别人在一起，不喜欢却也还是在一起。真的是她，坚强善良武装卑微懦弱，无法伤害别人致使自己无法抽身，自卑畏惧不敢大声言爱。我放纵到底，睡觉逃课打游戏逃避责任。有时候的确觉得愧疚，无法兑现许下的承诺。我不敢反驳我不渣，也不认同我是渣男。但爱情面前谁无对错？我的逃避，她的畏惧。如果…。没有如果，没有稚嫩，没有胆怯哪里还有青春。梦想中的爱情真的存在么？</p><p>她闺蜜给我发了一篇文章《梦想中的爱情》，出自她之手，洋洋洒洒好几篇。我没仔细看，大抵是讲她和另外一个人相遇相知的故事。这次大概就永不相见了吧，因为她的爱情已经有了结局。这样挺好，她不会再为害怕失去一个人而加倍的对一个人好，不会再为害怕失去一个人永不生气，不会再为害怕失去一个人不敢抬头。希望她对我说我教会她成长，对我说她过的比我好。虽然不在联系人，却也总想从班级群，留言板，亦或是评论区进她的空间看看最近动态，恍然才发觉我的每一条日志都有她的评论…。2013-05-13，那是我们分手后，原来不只是我一个人这样，三生有幸遇见你，他之于你大抵不过如此吧？</p><p>其实是有点羡慕的，越长大越孤单，有时一个人久了也会难免寂寞。心情疲倦的时候也会很想找个另一半，但在光怪陆离的社会，感觉越来越无法爱了。是游戏不好玩么，为什么要去谈恋爱？谈一场恋爱消费的是时间，精力，财力，心力。到头来也许只是竹篮打水一场空。我在深圳看见许多30的大龄单身男女青年。物质精神需求的提高，让大多数女人想找即有钱，对自己又好的男人。除了富二代或是家里有矿的，刚大学的男孩子拼命的赚钱，大多数到30岁都不知道能否在一线城市付个首付。谁还有精力去谈恋爱。单着也挺好，不是么？一人吃饱，全家不饿。</p><p>船到桥头自然直。</p><p>此生随缘，望相遇便是团圆！</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;此生相遇，便是团圆。&lt;/p&gt;
&lt;p&gt;这是她的微信签名，此时遇见的不是我，我们相遇是在曾经。如今，我只不过是她前半生的过客，甚至连过客都不如了吧。&lt;/p&gt;
&lt;p&gt;回头看看，暮然惊觉，第一次与她相遇竟是在酒年前。时间还真是一把杀猪刀，不知不觉就屠宰了青春，九年里，读完了高中，上
      
    
    </summary>
    
    
      <category term="Book" scheme="https://panruipr.github.io/tags/Book/"/>
    
  </entry>
  
  <entry>
    <title>Spring-boot集成mybatis以及mybatis3的xml相关写法</title>
    <link href="https://panruipr.github.io/2018/10/22/Spring-Boot-Mybatis/"/>
    <id>https://panruipr.github.io/2018/10/22/Spring-Boot-Mybatis/</id>
    <published>2018-10-22T01:27:29.000Z</published>
    <updated>2018-10-30T05:30:49.701Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Spring-boot集成mybatis以及mybatis3的xml相关写法（mybatis-generator自动生成相关文件）"><a href="#Spring-boot集成mybatis以及mybatis3的xml相关写法（mybatis-generator自动生成相关文件）" class="headerlink" title="Spring-boot集成mybatis以及mybatis3的xml相关写法（mybatis-generator自动生成相关文件）"></a>Spring-boot集成mybatis以及mybatis3的xml相关写法（mybatis-generator自动生成相关文件）</h2><p>思路:mybatis-generator集成在idea开发工具中，首先调用mybatis-generator的maven插件，根据具体数据库路径，文件存放方式配置文件，生成对应的代码文件。so ,首先配置pom.xml将maven插件配置进去。第二步配置generatorCofig.xml文件，让插件运行时按照文件约束来。<br>Game Start</p><h3 id="1-准备工作（相关jar包）"><a href="#1-准备工作（相关jar包）" class="headerlink" title="1.准备工作（相关jar包）"></a>1.准备工作（相关jar包）</h3><p>自动生成jar包Mybatis-Generator <a href="https://github.com/mybatis/generator/releases" target="_blank" rel="noopener">点击传送</a></p><p>连接mysql的数据库驱动Mysql-connector <a href="https://dev.mysql.com/downloads/connector/j/" target="_blank" rel="noopener">点击传送</a></p><p><strong>传说:</strong>下载的时候选择Platform Independent，下载版本貌似6以上的版本生成的文件都只有insert，5以下的版本据说是有的，当然前提是数据库表已设置primary key.</p><h3 id="2-配置pom文件，引入maven插件以及mysql-connector"><a href="#2-配置pom文件，引入maven插件以及mysql-connector" class="headerlink" title="2.配置pom文件，引入maven插件以及mysql-connector"></a>2.配置pom文件，引入maven插件以及mysql-connector</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.46<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- mybatis自动生成文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">configurationFile</span>&gt;</span>$&#123;basedir&#125;/src/main/resources/generator/generatorConfig.xml<span class="tag">&lt;/<span class="name">configurationFile</span>&gt;</span><span class="comment">&lt;!-- 需要读取的配置文件的路径 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">overwrite</span>&gt;</span>true<span class="tag">&lt;/<span class="name">overwrite</span>&gt;</span><span class="comment">&lt;!-- 覆盖已经生成的文件，防止重复导入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">verbose</span>&gt;</span>true<span class="tag">&lt;/<span class="name">verbose</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-配置genneratorConfig-xml设定好生成路径"><a href="#3-配置genneratorConfig-xml设定好生成路径" class="headerlink" title="3.配置genneratorConfig.xml设定好生成路径"></a>3.配置genneratorConfig.xml设定好生成路径</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE generatorConfiguration</span></span><br><span class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</span></span><br><span class="line"><span class="meta">        "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 数据库驱动:选择你的本地硬盘上面的数据库驱动包--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">classPathEntry</span>  <span class="attr">location</span>=<span class="string">"C:/Users/panrui/progress/mybatis/mysql-connector-java-8.0.13/mysql-connector-java-8.0.13.jar"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"DB2Tables"</span>  <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suppressDate"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 是否去除自动生成的注释 true：是 ： false:否 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suppressAllComments"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--数据库连接驱动类,URL，用户名、密码 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">"com.mysql.jdbc.Driver"</span> <span class="attr">connectionURL</span>=<span class="string">"jdbc:mysql://127.0.0.1:3306/business"</span> <span class="attr">userId</span>=<span class="string">"user"</span> <span class="attr">password</span>=<span class="string">"password"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"forceBigDecimals"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 生成(实体)模型的包名和位置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com.pr.amaz.model"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span>&gt;</span><span class="comment">&lt;!-- 此路径根据自己项目地址调整，可能不需要/main/java --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"trimStrings"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 生成XML映射文件的包名和位置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"resources.mapping"</span> <span class="attr">targetProject</span>=<span class="string">"src/main"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 生成DAO接口的包名和位置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">type</span>=<span class="string">"XMLMAPPER"</span> <span class="attr">targetPackage</span>=<span class="string">"com.pr.amaz.mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 要生成的表 tableName是数据库中的表名或视图名 domainObjectName是实体类名--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"b_user"</span> <span class="attr">domainObjectName</span>=<span class="string">"UserInfo"</span> <span class="attr">enableCountByExample</span>=<span class="string">"false"</span> <span class="attr">enableUpdateByExample</span>=<span class="string">"false"</span> <span class="attr">enableDeleteByExample</span>=<span class="string">"false"</span> <span class="attr">enableSelectByExample</span>=<span class="string">"false"</span> <span class="attr">selectByExampleQueryId</span>=<span class="string">"false"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="comment">&lt;!-- 这些参数设置成true 会生成衍生文件用来查询，目前还不知道怎么用。 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-运行mybatis-genenrator"><a href="#3-运行mybatis-genenrator" class="headerlink" title="3.运行mybatis-genenrator"></a>3.运行mybatis-genenrator</h3><p>在Runs—-&gt;Edit Configurations新建maven命令填写为:mybatis-generator:generate -e<br>下面是生成好的xml文件，实体类，接口我就放了</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.pr.amaz.mapper.UserInfoMapper"</span> &gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"BaseResultMap"</span> <span class="attr">type</span>=<span class="string">"com.pr.amaz.model.UserInfo"</span> &gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">      WARNING - @mbggenerated</span></span><br><span class="line"><span class="comment">      This element is automatically generated by MyBatis Generator, do not modify.</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"userid"</span> <span class="attr">property</span>=<span class="string">"userid"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"username"</span> <span class="attr">property</span>=<span class="string">"username"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"usersex"</span> <span class="attr">property</span>=<span class="string">"usersex"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"reallyname"</span> <span class="attr">property</span>=<span class="string">"reallyname"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"creattime"</span> <span class="attr">property</span>=<span class="string">"creattime"</span> <span class="attr">jdbcType</span>=<span class="string">"DATE"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"powerLevel"</span> <span class="attr">property</span>=<span class="string">"powerlevel"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"rolename"</span> <span class="attr">property</span>=<span class="string">"rolename"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">property</span>=<span class="string">"email"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"phone"</span> <span class="attr">property</span>=<span class="string">"phone"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"attribute1"</span> <span class="attr">property</span>=<span class="string">"attribute1"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"attribute2"</span> <span class="attr">property</span>=<span class="string">"attribute2"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"attribnte3"</span> <span class="attr">property</span>=<span class="string">"attribnte3"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insert"</span> <span class="attr">parameterType</span>=<span class="string">"com.pr.amaz.model.UserInfo"</span> &gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">      WARNING - @mbggenerated</span></span><br><span class="line"><span class="comment">      This element is automatically generated by MyBatis Generator, do not modify.</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    insert into b_user (userid, username, usersex, </span><br><span class="line">      reallyname, creattime, powerLevel, </span><br><span class="line">      rolename, email, phone, </span><br><span class="line">      attribute1, attribute2, attribnte3</span><br><span class="line">      )</span><br><span class="line">    values (#&#123;userid,jdbcType=VARCHAR&#125;, #&#123;username,jdbcType=VARCHAR&#125;, #&#123;usersex,jdbcType=VARCHAR&#125;, </span><br><span class="line">      #&#123;reallyname,jdbcType=VARCHAR&#125;, #&#123;creattime,jdbcType=DATE&#125;, #&#123;powerlevel,jdbcType=VARCHAR&#125;, </span><br><span class="line">      #&#123;rolename,jdbcType=VARCHAR&#125;, #&#123;email,jdbcType=VARCHAR&#125;, #&#123;phone,jdbcType=VARCHAR&#125;, </span><br><span class="line">      #&#123;attribute1,jdbcType=VARCHAR&#125;, #&#123;attribute2,jdbcType=VARCHAR&#125;, #&#123;attribnte3,jdbcType=VARCHAR&#125;</span><br><span class="line">      )</span><br><span class="line">  <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertSelective"</span> <span class="attr">parameterType</span>=<span class="string">"com.pr.amaz.model.UserInfo"</span> &gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">      WARNING - @mbggenerated</span></span><br><span class="line"><span class="comment">      This element is automatically generated by MyBatis Generator, do not modify.</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    insert into b_user</span><br><span class="line">    <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">"("</span> <span class="attr">suffix</span>=<span class="string">")"</span> <span class="attr">suffixOverrides</span>=<span class="string">","</span> &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"userid != null"</span> &gt;</span></span><br><span class="line">        userid,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"username != null"</span> &gt;</span></span><br><span class="line">        username,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"usersex != null"</span> &gt;</span></span><br><span class="line">        usersex,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"reallyname != null"</span> &gt;</span></span><br><span class="line">        reallyname,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"creattime != null"</span> &gt;</span></span><br><span class="line">        creattime,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"powerlevel != null"</span> &gt;</span></span><br><span class="line">        powerLevel,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"rolename != null"</span> &gt;</span></span><br><span class="line">        rolename,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"email != null"</span> &gt;</span></span><br><span class="line">        email,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"phone != null"</span> &gt;</span></span><br><span class="line">        phone,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"attribute1 != null"</span> &gt;</span></span><br><span class="line">        attribute1,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"attribute2 != null"</span> &gt;</span></span><br><span class="line">        attribute2,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"attribnte3 != null"</span> &gt;</span></span><br><span class="line">        attribnte3,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">"values ("</span> <span class="attr">suffix</span>=<span class="string">")"</span> <span class="attr">suffixOverrides</span>=<span class="string">","</span> &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"userid != null"</span> &gt;</span></span><br><span class="line">        #&#123;userid,jdbcType=VARCHAR&#125;,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"username != null"</span> &gt;</span></span><br><span class="line">        #&#123;username,jdbcType=VARCHAR&#125;,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"usersex != null"</span> &gt;</span></span><br><span class="line">        #&#123;usersex,jdbcType=VARCHAR&#125;,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"reallyname != null"</span> &gt;</span></span><br><span class="line">        #&#123;reallyname,jdbcType=VARCHAR&#125;,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"creattime != null"</span> &gt;</span></span><br><span class="line">        #&#123;creattime,jdbcType=DATE&#125;,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"powerlevel != null"</span> &gt;</span></span><br><span class="line">        #&#123;powerlevel,jdbcType=VARCHAR&#125;,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"rolename != null"</span> &gt;</span></span><br><span class="line">        #&#123;rolename,jdbcType=VARCHAR&#125;,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"email != null"</span> &gt;</span></span><br><span class="line">        #&#123;email,jdbcType=VARCHAR&#125;,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"phone != null"</span> &gt;</span></span><br><span class="line">        #&#123;phone,jdbcType=VARCHAR&#125;,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"attribute1 != null"</span> &gt;</span></span><br><span class="line">        #&#123;attribute1,jdbcType=VARCHAR&#125;,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"attribute2 != null"</span> &gt;</span></span><br><span class="line">        #&#123;attribute2,jdbcType=VARCHAR&#125;,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"attribnte3 != null"</span> &gt;</span></span><br><span class="line">        #&#123;attribnte3,jdbcType=VARCHAR&#125;,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--自己添加的 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectUserByPrimaryKey"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="4-简单编写xml文件语法"><a href="#4-简单编写xml文件语法" class="headerlink" title="4.简单编写xml文件语法"></a>4.简单编写xml文件语法</h3><p>mybatis3 采用了功能强大基于OGNL表达式，简化了许多元素，替代了以前很多元素，详情请见<a href="http://www.mybatis.org/mybatis-3/zh/dynamic-sql.html" target="_blank" rel="noopener">传送门</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Spring-boot集成mybatis以及mybatis3的xml相关写法（mybatis-generator自动生成相关文件）&quot;&gt;&lt;a href=&quot;#Spring-boot集成mybatis以及mybatis3的xml相关写法（mybatis-generato
      
    
    </summary>
    
    
      <category term="Java" scheme="https://panruipr.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Git的安装以及下载，上传项目以及下载项目</title>
    <link href="https://panruipr.github.io/2018/10/22/eclipse-git/"/>
    <id>https://panruipr.github.io/2018/10/22/eclipse-git/</id>
    <published>2018-10-22T01:27:29.000Z</published>
    <updated>2018-10-30T05:30:49.675Z</updated>
    
    <content type="html"><![CDATA[<h2 id="eclipse中安装git-并从github上传下载项目"><a href="#eclipse中安装git-并从github上传下载项目" class="headerlink" title="eclipse中安装git,并从github上传下载项目"></a>eclipse中安装git,并从github上传下载项目</h2><h3 id="1-下载git并安装git"><a href="#1-下载git并安装git" class="headerlink" title="1.下载git并安装git"></a>1.下载git并安装git</h3><p>在安装git的时候到最后会有一个选择应用的地方，选择到eclipse等应用中。这样eclipse会默认git的相关配置。</p><h5 id="1-生成秘钥"><a href="#1-生成秘钥" class="headerlink" title="1.生成秘钥"></a>1.生成秘钥</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd  ~/.ssh #查看电脑上是否已经存在ssh秘钥</span><br><span class="line">ssh-keygen -t rsa -C "your_email@youremail.com #输入你github注册时候的地址</span><br><span class="line"><span class="meta">#</span><span class="bash">之后会让你输入两次密码，可以直接按enter跳过也可以输入，之后会生成id_rsa.pub和 idrsa.pub两个文件</span></span><br></pre></td></tr></table></figure><h5 id="2-复制秘钥到github中"><a href="#2-复制秘钥到github中" class="headerlink" title="2.复制秘钥到github中"></a>2.复制秘钥到github中</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">在github的Settings中的SSH Keys添加本地id_rsa.pub中的秘钥 秘钥是以-ssh 开头 邮箱结尾</span></span><br><span class="line">ssh -T git@github.com #测试连接</span><br></pre></td></tr></table></figure><h5 id="3-设置自己的相关信息"><a href="#3-设置自己的相关信息" class="headerlink" title="3.设置自己的相关信息"></a>3.设置自己的相关信息</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name "Firstname Lastname" #设置你提交的时候使用的用户名</span><br><span class="line">git config --global user.email "your_email@youremail.com" #邮箱最好使用注册时的邮箱</span><br></pre></td></tr></table></figure><h5 id="4-下载github的项目到本地"><a href="#4-下载github的项目到本地" class="headerlink" title="4.下载github的项目到本地"></a>4.下载github的项目到本地</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/username/xxxx.git</span><br></pre></td></tr></table></figure><h5 id="5-eclipse中导入项目"><a href="#5-eclipse中导入项目" class="headerlink" title="5.eclipse中导入项目"></a>5.eclipse中导入项目</h5><p><strong>eclipse:</strong>打开git视图，点击 add an existing local Git repository.选择刚刚克隆下来的项目地址。点击项目export导项目就可以导入了。</p><p><strong>idea</strong>:在idea中点击左上角的vcs选择checke out from Github 填入项目的https地址</p><h5 id="6-提交项目至github"><a href="#6-提交项目至github" class="headerlink" title="6.提交项目至github"></a>6.提交项目至github</h5><p><strong>eclipse:</strong> 右键工程项目之后选择git点击commit and push 这样就会提交到本地仓库的同时提交到Github</p><p><strong>idea:</strong>在idea中点击commit 只会提交到本地仓库，然后在点击vcs，里面会有一个push，确定之后就可以提交至Github，如果要求输入密码就输入之前设置的密码</p><p>注意:如果开发工具中没有设置好对应的配置，idea中在settings—-&gt;git里指定git.exe的路径。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;eclipse中安装git-并从github上传下载项目&quot;&gt;&lt;a href=&quot;#eclipse中安装git-并从github上传下载项目&quot; class=&quot;headerlink&quot; title=&quot;eclipse中安装git,并从github上传下载项目&quot;&gt;&lt;/a&gt;ec
      
    
    </summary>
    
    
      <category term="Java" scheme="https://panruipr.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>java中使用poi来生成excel</title>
    <link href="https://panruipr.github.io/2018/10/09/PoiCreateExcel/"/>
    <id>https://panruipr.github.io/2018/10/09/PoiCreateExcel/</id>
    <published>2018-10-09T05:21:28.000Z</published>
    <updated>2019-01-07T12:11:56.844Z</updated>
    
    <content type="html"><![CDATA[<h2 id="使用poi根据模板生成excel"><a href="#使用poi根据模板生成excel" class="headerlink" title="使用poi根据模板生成excel"></a>使用poi根据模板生成excel</h2><h3 id="1-导入相关jar包"><a href="#1-导入相关jar包" class="headerlink" title="1.导入相关jar包"></a>1.导入相关jar包</h3><ul><li>poi.jar</li><li>poi-ooxml.jar</li><li>poi-examples.jar</li><li>poi-excelant.jar</li><li>poi-ooxml-schemas.jar</li><li>poi-scratchpad.jar</li></ul><p>pom文件相关配置如下，以3.17版本为例。<a href="http://poi.apache.org/download.html" target="_blank" rel="noopener">传送门</a></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-examples<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-excelant<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml-schemas<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-scratchpad<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-读取模板填充新数据"><a href="#2-读取模板填充新数据" class="headerlink" title="2.读取模板填充新数据"></a>2.读取模板填充新数据</h3><p>HSSFWorkbook是Excel2003版本之前的操作方式，扩展名为.xls</p><p>XSSFWorkbook是Excel2007版本之后的操作方式，扩展名为.xlsx</p><p>代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFCell;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PoiReadExcel</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">String path = <span class="string">"C:\\Users\\xxxx\\Desktop\\TestModul.xlsx"</span>;</span><br><span class="line">String targetPath = <span class="string">"C:\\Users\\xxxxx\\Desktop\\TestSuccess.xlsx"</span>;</span><br><span class="line">File file = <span class="keyword">new</span> File(path);</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//1.创建工作薄workbook对象</span></span><br><span class="line">XSSFWorkbook xfw = <span class="keyword">new</span> XSSFWorkbook(<span class="keyword">new</span> FileInputStream(file));</span><br><span class="line">                <span class="comment">//2.根据sheet的名称获取相应的sheet页对象</span></span><br><span class="line">XSSFSheet xs = xfw.getSheet(<span class="string">"Sheet1"</span>);</span><br><span class="line">                <span class="comment">//3.设置自动计算，</span></span><br><span class="line">xs.setForceFormulaRecalculation(<span class="keyword">true</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">5</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">                    <span class="comment">//4.在excel表插入一行数据的时候一定要将当前以后的表格向下移动一行，否则不生效</span></span><br><span class="line">xs.shiftRows(i, xs.getLastRowNum(), <span class="number">1</span>);</span><br><span class="line">                    <span class="comment">//5.创建新的一行</span></span><br><span class="line">XSSFRow row = xs.createRow(i);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> y=<span class="number">0</span>;y&lt;<span class="number">2</span>;y++)&#123;</span><br><span class="line">                        <span class="comment">//6.获取这一行的某一列的单元格</span></span><br><span class="line">XSSFCell cell = row.createCell(y);</span><br><span class="line">                        <span class="comment">//因为我这里是插入新的一行，没有样式，此处为将下一行的单元格格式复制给新插入的行</span></span><br><span class="line">cell.setCellStyle(xs.getRow(i+<span class="number">1</span>).getCell(y).getCellStyle());</span><br><span class="line">String str = <span class="string">"-0.123456"</span>;</span><br><span class="line">Boolean isnum = str.matches(<span class="string">"-[0-9]+(.[0-9]+)?|[0-9]+(.[0-9]+)?"</span>);</span><br><span class="line">System.out.println(isnum);</span><br><span class="line"><span class="keyword">if</span>(isnum)&#123;</span><br><span class="line">                            <span class="comment">//7.这里要注意，excel表中有单元格格式，例如百分比，数值，文本等。如果如果是数字在填充单元格的时候要转换成Double类型的，否则就会变成纯文本。</span></span><br><span class="line">cell.setCellValue(Double.valueOf(str));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">        <span class="comment">/*结语：直接给sheet页赋值只需要使用sheet.getRow(1).getCell(1).setCellValue(1);在此过程中记得对Row和Cell，因为从模板中拿出来的行和单元格并不一定有值。否则很容易NullPointerException</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">FileOutputStream out = <span class="keyword">new</span> FileOutputStream(targetPath);</span><br><span class="line">xfw.write(out);</span><br><span class="line">                out.close();</span><br><span class="line">xfw.close();</span><br><span class="line">&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">System.out.println(<span class="string">"Not Found This File ::"</span> + path);</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-常用方法扩充"><a href="#3-常用方法扩充" class="headerlink" title="3.常用方法扩充"></a>3.常用方法扩充</h3><table><thead><tr><th style="text-align:left">方法名称</th><th style="text-align:left">方法说明</th></tr></thead><tbody><tr><td style="text-align:left">getRowStyle()</td><td style="text-align:left">获取一行的样式</td></tr><tr><td style="text-align:left">getRowStyle().getFillForegroundXSSFColor();</td><td style="text-align:left">获取此行的当前背景颜色(excel默认格式所带颜色读取不出来，在excel表中查看当前行背景颜色也为空白)</td></tr></tbody></table><h3 id="4-问题以及想法"><a href="#4-问题以及想法" class="headerlink" title="4.问题以及想法"></a>4.问题以及想法</h3><pre><code>poi自身对于excel的支持算是比较高的了，当excel表中装有第三方插件，需要用到第三方插件库的函数时，例如wind,无法去掉wind函数公式，只留数值。尝试过用宏来实现去公式，但需要一台window服务器暂且不说，还得excel的模板中先预先设置好相同名称的宏比较麻烦，最后在测试过程中使用宏来去公式的确可以实现，但是在程序调用过程中excel报错提示信息太多。最终也没有找到满意的解决方案。。。</code></pre><h3 id="5-功能补充（2018-12-03）"><a href="#5-功能补充（2018-12-03）" class="headerlink" title="5.功能补充（2018-12-03）"></a>5.功能补充（2018-12-03）</h3><p>多sheet页拆分成excel</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将多sheet页拆分成多个excel表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> Exception </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">splitExcelSheet</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">File file = <span class="keyword">new</span> File(<span class="string">"C:\\Users\\x_panrui\\Desktop\\olol.xlsx"</span>);</span><br><span class="line">InputStream in = <span class="keyword">null</span>;</span><br><span class="line">XSSFWorkbook xf = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">in = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">xf = <span class="keyword">new</span> XSSFWorkbook(in);</span><br><span class="line"><span class="keyword">int</span> sheetlength = xf.getNumberOfSheets();</span><br><span class="line"><span class="comment">//循环遍历所有的sheet页名称</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> h = <span class="number">0</span>;h&lt;sheetlength;h++) &#123;</span><br><span class="line">InputStream is = <span class="keyword">new</span> FileInputStream(<span class="keyword">new</span> File(<span class="string">"C:\\Users\\x_panrui\\Desktop\\olol.xlsx"</span>));</span><br><span class="line">XSSFWorkbook workbook = <span class="keyword">new</span> XSSFWorkbook(is);</span><br><span class="line">String sheetname = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> y = <span class="number">0</span>;y&lt;sheetlength;y++ ) &#123;</span><br><span class="line"><span class="keyword">if</span>(h!=y) &#123;</span><br><span class="line">                   <span class="comment">//将本次多余的sheet页去除</span></span><br><span class="line">workbook.removeSheetAt(workbook.getSheetIndex(xf.getSheetName(y)));</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">sheetname = xf.getSheetName(y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">File targetFile = <span class="keyword">new</span> File(<span class="string">"C:\\Users\\x_panrui\\Desktop\\split\\"</span> +sheetname +<span class="string">".xlsx"</span>);</span><br><span class="line">File parentFile = targetFile.getParentFile();</span><br><span class="line"><span class="keyword">if</span>(!parentFile.exists()) &#123;</span><br><span class="line">parentFile.mkdirs();</span><br><span class="line">&#125;</span><br><span class="line">FileOutputStream fileOut = <span class="keyword">new</span> FileOutputStream(targetFile);</span><br><span class="line">workbook.write(fileOut);</span><br><span class="line">fileOut.close();</span><br><span class="line">workbook.close();</span><br><span class="line">&#125;</span><br><span class="line">xf.close();</span><br><span class="line">in.close();</span><br><span class="line">&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">System.out.println(<span class="string">"文件不存在！"</span> + e.toString());</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">System.out.println(<span class="string">"io流读取失败"</span> + e.toString());</span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>读取excel，(如果是合并单元个格的excel，只有第一行数据有，和excel单元格的坐标是一致的)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">readExcel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">File file = <span class="keyword">new</span> File(<span class="string">"C:\\Users\\x_panrui\\Desktop\\olol.xlsx"</span>);</span><br><span class="line">InputStream in = <span class="keyword">null</span>;</span><br><span class="line">XSSFWorkbook xf = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">in = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">xf = <span class="keyword">new</span> XSSFWorkbook(in);</span><br><span class="line"><span class="comment">//循环遍历所有的sheet页名称</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;xf.getNumberOfSheets();i++) &#123;</span><br><span class="line">            <span class="comment">//获取sheet页名称，以便获取sheet对象</span></span><br><span class="line">String sheetname = xf.getSheetName(i);</span><br><span class="line">XSSFSheet sheet = xf.getSheet(sheetname);</span><br><span class="line">             <span class="comment">//获取总行数</span></span><br><span class="line"><span class="keyword">int</span> rowNum = sheet.getLastRowNum();</span><br><span class="line">            <span class="comment">//循环遍历每一行数据</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> y = <span class="number">0</span>;y&lt;rowNum;y++) &#123;</span><br><span class="line">String rowString = <span class="string">""</span>;</span><br><span class="line">XSSFRow row  = sheet.getRow(y);</span><br><span class="line">                   <span class="comment">//获取总列数</span></span><br><span class="line"><span class="keyword">int</span> cellNum = row.getLastCellNum();</span><br><span class="line">                    <span class="comment">//循环遍历每一行中单元格的值</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> h = <span class="number">0</span>;h&lt;cellNum;h++) &#123;</span><br><span class="line">XSSFCell xfcell = row.getCell(h);</span><br><span class="line">CellType type = xfcell.getCellTypeEnum();</span><br><span class="line">                       <span class="comment">//判断单元格值得类型,采取不同的取值方式</span></span><br><span class="line"><span class="keyword">if</span>((CellType.NUMERIC).equals(type)) &#123;</span><br><span class="line">rowString += String.valueOf(xfcell.getNumericCellValue())+<span class="string">","</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>((CellType.STRING).equals(type)) &#123;</span><br><span class="line">rowString +=  xfcell.getStringCellValue()+<span class="string">","</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>((CellType.BLANK).equals(type)) &#123;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(rowString);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">System.out.println(<span class="string">"文件不存在！"</span> + e.toString());</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">System.out.println(<span class="string">"io流读取失败"</span> + e.toString());</span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将excel转换成html(粘的其他人的，小幅度做了一点调整，请使用poi-3.17。之前的老版本一些参数变量并没有换成枚举类)。excel表系统自带格式颜色是拿不到的，只能去当前背景颜色，如果没有就没有。调用方式如下:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将excel转换成html</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">excelToHtml</span><span class="params">()</span> </span>&#123;</span><br><span class="line">File file = <span class="keyword">new</span> File(<span class="string">"C:\\Users\\x_panrui\\Desktop\\olol.xlsx"</span>);</span><br><span class="line">InputStream in = <span class="keyword">null</span>;</span><br><span class="line">XSSFWorkbook xf = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">in = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">xf = <span class="keyword">new</span> XSSFWorkbook(in);</span><br><span class="line">ArrayList&lt;String&gt; sheetList = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> z=<span class="number">0</span>;z&lt;xf.getNumberOfSheets();z++) &#123;</span><br><span class="line">sheetList.add(xf.getSheetName(z));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//循环遍历所有的sheet页名称</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;xf.getNumberOfSheets();i++) &#123;</span><br><span class="line">String sheetname = xf.getSheetName(i);</span><br><span class="line">String  html = ExcelToHtmlUtils.getExcelInfo(xf, <span class="keyword">true</span>, sheetname);</span><br><span class="line">ExcelToHtmlUtils.writeFile(html, <span class="string">"C:\\Users\\x_panrui\\Desktop\\split\\sheet"</span> + i + <span class="string">".htm"</span>);</span><br><span class="line">&#125;  ExcelToHtmlUtils.writeFile(ExcelToHtmlUtils.CreatIndexHtml(sheetList),<span class="string">"C:\\Users\\x_panrui\\Desktop\\split\\test.htm"</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">System.out.println(<span class="string">"文件不存在！"</span> + e.toString());</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">System.out.println(<span class="string">"io流读取失败"</span> + e.toString());</span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.panrui.pr;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.text.DecimalFormat;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFCell;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFCellStyle;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFDataFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFDateUtil;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFFont;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFPalette;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFWorkbook;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.util.HSSFColor;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.VerticalAlignment;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Cell;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.CellStyle;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.HorizontalAlignment;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Sheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Workbook;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.util.StringUtil;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFCellStyle;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFColor;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFFont;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelToHtmlUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span>  Map&lt;String, Object&gt; map[];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getExcelInfo</span><span class="params">(Workbook wb, <span class="keyword">boolean</span> isWithStyle,String sheetname)</span></span>&#123;</span><br><span class="line">StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">Sheet sheet = wb.getSheet(sheetname);</span><br><span class="line"><span class="comment">// map等待存储excel图片</span></span><br><span class="line"><span class="comment">/*Map&lt;String, PictureData&gt; sheetIndexPicMap = getSheetPictrues(0, sheet, wb);</span></span><br><span class="line"><span class="comment">//临时保存位置，正式环境根据部署环境存放其他位置</span></span><br><span class="line"><span class="comment">try &#123;</span></span><br><span class="line"><span class="comment">if(sheetIndexPicMap != null)</span></span><br><span class="line"><span class="comment">printImg(sheetIndexPicMap);</span></span><br><span class="line"><span class="comment">&#125; catch (IOException e) &#123;</span></span><br><span class="line"><span class="comment">e.printStackTrace();</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//读取excel拼装html</span></span><br><span class="line"><span class="keyword">int</span> lastRowNum = sheet.getLastRowNum();</span><br><span class="line"></span><br><span class="line">map = getRowSpanColSpanMap(sheet);</span><br><span class="line">sb.append(<span class="string">"&lt;table style='border-collapse:collapse;'&gt;"</span>);</span><br><span class="line">Row row = <span class="keyword">null</span>;        <span class="comment">//兼容</span></span><br><span class="line">Cell cell = <span class="keyword">null</span>;    <span class="comment">//兼容</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> rowNum = sheet.getFirstRowNum(); rowNum &lt;= lastRowNum; rowNum ++) &#123;</span><br><span class="line"><span class="keyword">if</span>(rowNum &gt; <span class="number">1000</span>) <span class="keyword">break</span>;</span><br><span class="line">row = sheet.getRow(rowNum);</span><br><span class="line"><span class="keyword">int</span> lastColNum = ExcelToHtmlUtils.getColsOfTable(sheet)[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">int</span> rowHeight = ExcelToHtmlUtils.getColsOfTable(sheet)[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">null</span> != row) &#123;</span><br><span class="line">lastColNum = row.getLastCellNum();</span><br><span class="line">rowHeight = row.getHeight();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">null</span> == row) &#123;</span><br><span class="line"><span class="comment">//sb.append("&lt;tr&gt;&lt;td &gt;  &lt;/td&gt;&lt;/tr&gt;");</span></span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(row.getZeroHeight())&#123;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="number">0</span> == rowHeight)&#123;</span><br><span class="line"><span class="keyword">continue</span>;     <span class="comment">//针对jxl的隐藏行（此类隐藏行只是把高度设置为0，单getZeroHeight无法识别）</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(row <span class="keyword">instanceof</span> XSSFRow &amp;&amp; row!=<span class="keyword">null</span> &amp;&amp; row.getRowStyle()!=<span class="keyword">null</span>)&#123;</span><br><span class="line"> XSSFColor rowColor = ((XSSFRow)row).getRowStyle().getFillForegroundXSSFColor();</span><br><span class="line"> <span class="keyword">if</span>(rowColor!=<span class="keyword">null</span>)&#123;</span><br><span class="line"> String rowcolor = rowColor.getARGBHex();</span><br><span class="line"> sb.append(<span class="string">"&lt;tr style='"</span>);</span><br><span class="line"> sb.append(<span class="string">"background-color:#"</span> + rowcolor.substring(<span class="number">0</span>,rowcolor.length()-<span class="number">2</span>));</span><br><span class="line"> sb.append(<span class="string">"'&gt;"</span>);</span><br><span class="line"> &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"> sb.append(<span class="string">"&lt;tr style='"</span>);</span><br><span class="line"> sb.append(<span class="string">"'&gt;"</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>(row <span class="keyword">instanceof</span> HSSFRow &amp;&amp; row!=<span class="keyword">null</span> &amp;&amp; row.getRowStyle()!=<span class="keyword">null</span>)&#123;</span><br><span class="line"> HSSFColor rowColor = ((HSSFRow)row).getRowStyle().getFillForegroundColorColor();</span><br><span class="line"> String rowcolor = rowColor.getHexString();</span><br><span class="line"> sb.append(<span class="string">"&lt;tr style='"</span>);</span><br><span class="line"> sb.append(<span class="string">"background-color:#"</span> + rowcolor);</span><br><span class="line"> sb.append(<span class="string">"'&gt;"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">sb.append(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">&#125;</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> colNum = <span class="number">0</span>; colNum &lt; lastColNum; colNum ++) &#123;</span><br><span class="line"><span class="keyword">if</span>(sheet.isColumnHidden(colNum))<span class="keyword">continue</span>;</span><br><span class="line">String imageRowNum = <span class="string">"0_"</span> + rowNum + <span class="string">"_"</span> + colNum;</span><br><span class="line">String imageHtml = <span class="string">""</span>;</span><br><span class="line">cell = row.getCell(colNum);</span><br><span class="line"><span class="comment">/*if ((sheetIndexPicMap != null &amp;&amp; !sheetIndexPicMap.containsKey(imageRowNum) || sheetIndexPicMap == null) &amp;&amp; cell == null) &#123;    //特殊情况 空白的单元格会返回null+//判断该单元格是否包含图片，为空时也可能包含图片</span></span><br><span class="line"><span class="comment">sb.append("&lt;td&gt;  &lt;/td&gt;");</span></span><br><span class="line"><span class="comment">continue;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">if(sheetIndexPicMap!=null &amp;&amp; sheetIndexPicMap.containsKey(imageRowNum))&#123;</span></span><br><span class="line"><span class="comment">//待修改路径</span></span><br><span class="line"><span class="comment">String imagePath = "D:\\pic" + imageRowNum + ".jpeg";</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">imageHtml = "&lt;img src='" + imagePath + "' style='height:" + rowHeight / 20 + "px;'&gt;";</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line">String stringValue = getCellValue(cell);</span><br><span class="line"><span class="keyword">if</span> (map[<span class="number">0</span>].containsKey(rowNum + <span class="string">","</span> + colNum)) &#123;</span><br><span class="line">String pointString = (String)map[<span class="number">0</span>].get(rowNum + <span class="string">","</span> + colNum);</span><br><span class="line"><span class="keyword">int</span> bottomeRow = Integer.valueOf(pointString.split(<span class="string">","</span>)[<span class="number">0</span>]);</span><br><span class="line"><span class="keyword">int</span> bottomeCol = Integer.valueOf(pointString.split(<span class="string">","</span>)[<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">int</span> rowSpan = bottomeRow - rowNum + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> colSpan = bottomeCol - colNum + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(map[<span class="number">2</span>].containsKey(rowNum + <span class="string">","</span> + colNum))&#123;</span><br><span class="line">rowSpan = rowSpan - (Integer)map[<span class="number">2</span>].get(rowNum + <span class="string">","</span> + colNum);</span><br><span class="line">&#125;</span><br><span class="line">sb.append(<span class="string">"&lt;td rowspan= '"</span> + rowSpan + <span class="string">"' colspan= '"</span>+ colSpan + <span class="string">"' "</span>);</span><br><span class="line"><span class="keyword">if</span>(map.length &gt; <span class="number">3</span> &amp;&amp; map[<span class="number">3</span>].containsKey(rowNum + <span class="string">","</span> + colNum))&#123;</span><br><span class="line"><span class="comment">//此类数据首行被隐藏，value为空，需使用其他方式获取值</span></span><br><span class="line">stringValue = getMergedRegionValue(sheet, rowNum, colNum);</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (map[<span class="number">1</span>].containsKey(rowNum + <span class="string">","</span> + colNum)) &#123;</span><br><span class="line">map[<span class="number">1</span>].remove(rowNum + <span class="string">","</span> + colNum);</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">/*if(StringUtils.isNotBlank(stringValue))&#123;*/</span></span><br><span class="line">sb.append(<span class="string">"&lt;td "</span>);</span><br><span class="line"><span class="comment">/*&#125;*/</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//判断是否需要样式</span></span><br><span class="line"><span class="keyword">if</span>(isWithStyle)&#123;</span><br><span class="line"><span class="comment">/*if(StringUtils.isNotBlank(stringValue))&#123;*/</span></span><br><span class="line">dealExcelStyle(wb, sheet, cell, sb);<span class="comment">//处理单元格样式</span></span><br><span class="line"><span class="comment">/*&#125;*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*if(StringUtils.isNotBlank(stringValue))&#123;*/</span></span><br><span class="line">sb.append(<span class="string">"&gt;"</span>);</span><br><span class="line"><span class="comment">/*&#125;*/</span></span><br><span class="line"><span class="comment">/*if(sheetIndexPicMap!=null &amp;&amp; sheetIndexPicMap.containsKey(imageRowNum)) sb.append(imageHtml);*/</span></span><br><span class="line"><span class="keyword">if</span> (stringValue == <span class="keyword">null</span> || <span class="string">""</span>.equals(stringValue.trim())) &#123;</span><br><span class="line">sb.append(<span class="string">"   "</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// 将ascii码为160的空格转换为html下的空格（ ）</span></span><br><span class="line">sb.append(stringValue.replace(String.valueOf((<span class="keyword">char</span>) <span class="number">160</span>),<span class="string">" "</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*if(StringUtils.isNotBlank(stringValue))&#123;*/</span></span><br><span class="line">sb.append(<span class="string">"&lt;/td&gt;"</span>);</span><br><span class="line"><span class="comment">/*&#125;*/</span></span><br><span class="line">&#125;</span><br><span class="line">sb.append(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line">sb.append(<span class="string">"&lt;/table&gt;"</span>);</span><br><span class="line"><span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分析excel表格，记录合并单元格相关的参数，用于之后html页面元素的合并操作</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> sheet</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, Object&gt;[] getRowSpanColSpanMap(Sheet sheet) &#123;</span><br><span class="line">Map&lt;String, String&gt; map0 = <span class="keyword">new</span> HashMap&lt;String, String&gt;();<span class="comment">//保存合并单元格的对应起始和截止单元格</span></span><br><span class="line">Map&lt;String, String&gt; map1 = <span class="keyword">new</span> HashMap&lt;String, String&gt;();<span class="comment">//保存被合并的那些单元格</span></span><br><span class="line">Map&lt;String, Integer&gt; map2 = <span class="keyword">new</span> HashMap&lt;String, Integer&gt;();<span class="comment">//记录被隐藏的单元格个数</span></span><br><span class="line">Map&lt;String, String&gt; map3 = <span class="keyword">new</span> HashMap&lt;String, String&gt;();<span class="comment">//记录合并了单元格，但是合并的首行被隐藏的情况</span></span><br><span class="line"><span class="keyword">int</span> mergedNum = sheet.getNumMergedRegions();</span><br><span class="line">CellRangeAddress range = <span class="keyword">null</span>;</span><br><span class="line">Row row = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mergedNum; i++) &#123;</span><br><span class="line">range = sheet.getMergedRegion(i);</span><br><span class="line"><span class="keyword">int</span> topRow = range.getFirstRow();</span><br><span class="line"><span class="keyword">int</span> topCol = range.getFirstColumn();</span><br><span class="line"><span class="keyword">int</span> bottomRow = range.getLastRow();</span><br><span class="line"><span class="keyword">int</span> bottomCol = range.getLastColumn();</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 此类数据为合并了单元格的数据</span></span><br><span class="line"><span class="comment"> * 1.处理隐藏（只处理行隐藏，列隐藏poi已经处理）</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">if</span>(topRow != bottomRow)&#123;</span><br><span class="line"><span class="keyword">int</span> zeroRoleNum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> tempRow = topRow;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = topRow; j &lt;= bottomRow; j ++)&#123;</span><br><span class="line">row = sheet.getRow(j);</span><br><span class="line"><span class="keyword">if</span>(row.getZeroHeight() || row.getHeight() == <span class="number">0</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(j == tempRow)&#123;</span><br><span class="line"><span class="comment">//首行就进行隐藏，将rowTop向后移</span></span><br><span class="line">tempRow ++;</span><br><span class="line"><span class="keyword">continue</span>;<span class="comment">//由于top下移，后面计算rowSpan时会扣除移走的列，所以不必增加zeroRoleNum;</span></span><br><span class="line">&#125;</span><br><span class="line">zeroRoleNum ++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(tempRow != topRow)&#123;</span><br><span class="line">map3.put(tempRow + <span class="string">","</span> + topCol,topRow + <span class="string">","</span> + topCol);</span><br><span class="line">topRow = tempRow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(zeroRoleNum!=<span class="number">0</span>) map2.put(topRow + <span class="string">","</span> + topCol, zeroRoleNum);</span><br><span class="line">&#125;</span><br><span class="line">map0.put(topRow + <span class="string">","</span> + topCol, bottomRow + <span class="string">","</span> + bottomCol);</span><br><span class="line"><span class="keyword">int</span> tempRow = topRow;</span><br><span class="line"><span class="keyword">while</span> (tempRow &lt;= bottomRow) &#123;</span><br><span class="line"><span class="keyword">int</span> tempCol = topCol;</span><br><span class="line"><span class="keyword">while</span> (tempCol &lt;= bottomCol) &#123;</span><br><span class="line">map1.put(tempRow + <span class="string">","</span> + tempCol, topRow + <span class="string">","</span> + topCol);</span><br><span class="line">tempCol++;</span><br><span class="line">&#125;</span><br><span class="line">tempRow++;</span><br><span class="line">&#125;</span><br><span class="line">map1.remove(topRow + <span class="string">","</span> + topCol);</span><br><span class="line">&#125;</span><br><span class="line">Map[] map = &#123; map0, map1 ,map2,map3&#125;;</span><br><span class="line">System.err.println(map0);</span><br><span class="line"><span class="keyword">return</span> map;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取合并单元格的值</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> sheet</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> row</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> column</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getMergedRegionValue</span><span class="params">(Sheet sheet, <span class="keyword">int</span> row, <span class="keyword">int</span> column)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sheetMergeCount = sheet.getNumMergedRegions();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; sheetMergeCount ; i++)&#123;</span><br><span class="line">CellRangeAddress ca = sheet.getMergedRegion(i);</span><br><span class="line"><span class="keyword">int</span> firstColumn = ca.getFirstColumn();</span><br><span class="line"><span class="keyword">int</span> lastColumn = ca.getLastColumn();</span><br><span class="line"><span class="keyword">int</span> firstRow = ca.getFirstRow();</span><br><span class="line"><span class="keyword">int</span> lastRow = ca.getLastRow();</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span>(row &gt;= firstRow &amp;&amp; row &lt;= lastRow)&#123;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span>(column &gt;= firstColumn &amp;&amp; column &lt;= lastColumn)&#123;</span><br><span class="line">Row fRow = sheet.getRow(firstRow);</span><br><span class="line">Cell fCell = fRow.getCell(firstColumn);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> getCellValue(fCell) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">null</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取表格单元格Cell内容</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> cell</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">getCellValue</span><span class="params">(Cell cell)</span> </span>&#123;</span><br><span class="line">String result = <span class="keyword">new</span> String();</span><br><span class="line"><span class="keyword">if</span>(cell!=<span class="keyword">null</span>)&#123;</span><br><span class="line"><span class="keyword">switch</span> (cell.getCellType()) &#123;</span><br><span class="line"><span class="keyword">case</span> Cell.CELL_TYPE_NUMERIC:<span class="comment">// 数字类型</span></span><br><span class="line"><span class="keyword">if</span>(cell <span class="keyword">instanceof</span> HSSFCell)&#123;</span><br><span class="line"><span class="keyword">if</span> (HSSFDateUtil.isCellDateFormatted((HSSFCell) cell)) &#123;<span class="comment">// 处理日期格式、时间格式</span></span><br><span class="line">SimpleDateFormat sdf = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (cell.getCellStyle().getDataFormat() == HSSFDataFormat.getBuiltinFormat(<span class="string">"h:mm"</span>)) &#123;</span><br><span class="line">sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"HH:mm"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;<span class="comment">// 日期</span></span><br><span class="line">sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</span><br><span class="line">&#125;</span><br><span class="line">Date date = cell.getDateCellValue();</span><br><span class="line">result = sdf.format(date);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (cell.getCellStyle().getDataFormat() == <span class="number">58</span>) &#123;</span><br><span class="line"><span class="comment">// 处理自定义日期格式：m月d日(通过判断单元格的格式id解决，id的值是58)</span></span><br><span class="line">SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</span><br><span class="line"><span class="keyword">double</span> value = cell.getNumericCellValue();</span><br><span class="line">Date date = org.apache.poi.ss.usermodel.DateUtil</span><br><span class="line">.getJavaDate(value);</span><br><span class="line">result = sdf.format(date);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">double</span> value = cell.getNumericCellValue();</span><br><span class="line">CellStyle style = cell.getCellStyle();</span><br><span class="line">DecimalFormat format = <span class="keyword">new</span> DecimalFormat();</span><br><span class="line">String temp = style.getDataFormatString();</span><br><span class="line"><span class="comment">// 单元格设置成常规</span></span><br><span class="line"><span class="keyword">if</span> (temp.equals(<span class="string">"General"</span>)) &#123;</span><br><span class="line">format.applyPattern(<span class="string">"#"</span>);</span><br><span class="line">&#125;</span><br><span class="line">result = format.format(value);</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"> <span class="keyword">if</span> (cell.getCellStyle().getDataFormat() == <span class="number">58</span>) &#123;</span><br><span class="line"><span class="comment">// 处理自定义日期格式：m月d日(通过判断单元格的格式id解决，id的值是58)</span></span><br><span class="line">SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</span><br><span class="line"><span class="keyword">double</span> value = cell.getNumericCellValue();</span><br><span class="line">Date date = org.apache.poi.ss.usermodel.DateUtil</span><br><span class="line">.getJavaDate(value);</span><br><span class="line">result = sdf.format(date);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">double</span> value = cell.getNumericCellValue();</span><br><span class="line">CellStyle style = cell.getCellStyle();</span><br><span class="line">DecimalFormat format = <span class="keyword">new</span> DecimalFormat();</span><br><span class="line">String temp = style.getDataFormatString();</span><br><span class="line"><span class="comment">// 单元格设置成常规</span></span><br><span class="line"><span class="keyword">if</span> (temp.equals(<span class="string">"General"</span>)) &#123;</span><br><span class="line">format.applyPattern(<span class="string">"#"</span>);</span><br><span class="line">&#125;</span><br><span class="line">result = format.format(value);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> Cell.CELL_TYPE_STRING:<span class="comment">// String类型</span></span><br><span class="line">result = cell.getRichStringCellValue().toString();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> Cell.CELL_TYPE_BLANK:</span><br><span class="line">result = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">result = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 处理表格样式</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> wb</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> sheet</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> cell</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> sb</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">dealExcelStyle</span><span class="params">(Workbook wb, Sheet sheet, Cell cell, StringBuffer sb)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(cell!=<span class="keyword">null</span>)&#123;</span><br><span class="line">CellStyle cellStyle = cell.getCellStyle();</span><br><span class="line"><span class="keyword">if</span> (cellStyle != <span class="keyword">null</span>) &#123;</span><br><span class="line">HorizontalAlignment alignment = cellStyle.getAlignmentEnum();</span><br><span class="line">sb.append(<span class="string">"align='"</span> + convertAlignToHtml(alignment) + <span class="string">"' "</span>);<span class="comment">//单元格内容的水平对齐方式</span></span><br><span class="line">VerticalAlignment ver= cellStyle.getVerticalAlignmentEnum();</span><br><span class="line"> </span><br><span class="line">sb.append(<span class="string">"valign='"</span>+ convertVerticalAlignToHtml(ver)+ <span class="string">"' "</span>);<span class="comment">//单元格中内容的垂直排列方式</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (wb <span class="keyword">instanceof</span> XSSFWorkbook) &#123;</span><br><span class="line">XSSFFont xf = ((XSSFCellStyle) cellStyle).getFont();</span><br><span class="line"><span class="keyword">boolean</span> boldflag = xf.getBold();</span><br><span class="line">sb.append(<span class="string">"style='"</span>);</span><br><span class="line"><span class="keyword">if</span>(boldflag) &#123;</span><br><span class="line">sb.append(<span class="string">"font-weight:blod;"</span>); <span class="comment">// 字体加粗</span></span><br><span class="line">&#125;</span><br><span class="line">sb.append(<span class="string">"font-size: "</span> + xf.getFontHeight() / <span class="number">3</span> + <span class="string">"%;"</span>); <span class="comment">// 字体大小</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">int</span> topRow = cell.getRowIndex(),topColumn = cell.getColumnIndex();</span><br><span class="line"><span class="keyword">if</span>(map[<span class="number">0</span>].containsKey(topRow+<span class="string">","</span>+topColumn))&#123;<span class="comment">//该单元格为合并单元格，宽度需要获取所有单元格宽度后合并</span></span><br><span class="line">String value = (String)map[<span class="number">0</span>].get(topRow+<span class="string">","</span>+topColumn);</span><br><span class="line">String[] ary = value.split(<span class="string">","</span>);</span><br><span class="line"><span class="keyword">int</span> bottomColumn = Integer.parseInt(ary[<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">if</span>(topColumn!=bottomColumn)&#123;<span class="comment">//合并列，需要计算相应宽度</span></span><br><span class="line"><span class="keyword">int</span> columnWidth = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=topColumn;i&lt;=bottomColumn;i++)&#123;</span><br><span class="line">columnWidth += sheet.getColumnWidth(i);</span><br><span class="line">&#125;</span><br><span class="line">sb.append(<span class="string">"width:"</span> + columnWidth/<span class="number">546</span>*xf.getFontHeight()/<span class="number">20</span> + <span class="string">"pt;"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">int</span> columnWidth = sheet.getColumnWidth(cell.getColumnIndex()) ;</span><br><span class="line">sb.append(<span class="string">"width:"</span> + columnWidth/<span class="number">546</span>*xf.getFontHeight()/<span class="number">20</span> + <span class="string">"pt;"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">int</span> columnWidth = sheet.getColumnWidth(cell.getColumnIndex()) ;</span><br><span class="line">sb.append(<span class="string">"width:"</span> + columnWidth/<span class="number">546</span>*xf.getFontHeight()/<span class="number">20</span> + <span class="string">"pt;"</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">XSSFColor xc = xf.getXSSFColor();</span><br><span class="line"><span class="keyword">if</span> (xc != <span class="keyword">null</span> &amp;&amp; !<span class="string">""</span>.equals(xc.toString())) &#123;</span><br><span class="line"><span class="keyword">if</span>(!xc.getARGBHex().substring(<span class="number">2</span>).equals(<span class="string">"FFFFFF"</span>))&#123;</span><br><span class="line">sb.append(<span class="string">"color:#"</span> + xc.getARGBHex().substring(<span class="number">2</span>) + <span class="string">";"</span>); <span class="comment">// 字体颜色</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">               </span><br><span class="line">XSSFColor bgColor = (XSSFColor) cellStyle.getFillForegroundColorColor();</span><br><span class="line"><span class="keyword">if</span> (bgColor != <span class="keyword">null</span> &amp;&amp; !<span class="string">""</span>.equals(bgColor.toString())) &#123;</span><br><span class="line">sb.append(<span class="string">"background-color:#"</span> + bgColor.getARGBHex().substring(<span class="number">2</span>) + <span class="string">";"</span>); <span class="comment">// 背景颜色</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(StringUtils.isNotBlank(getCellValue(cell)))&#123;</span><br><span class="line">sb.append(<span class="string">"border:solid #000000 1px;"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">sb.append(<span class="string">"border:#FFFFFF;"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//                sb.append(getBorderStyle(0,cellStyle.getBorderTop(), ((XSSFCellStyle) cellStyle).getTopBorderXSSFColor()));</span></span><br><span class="line"><span class="comment">//                sb.append(getBorderStyle(1,cellStyle.getBorderRight(), ((XSSFCellStyle) cellStyle).getRightBorderXSSFColor()));</span></span><br><span class="line"><span class="comment">//                sb.append(getBorderStyle(2,cellStyle.getBorderBottom(), ((XSSFCellStyle) cellStyle).getBottomBorderXSSFColor()));</span></span><br><span class="line"><span class="comment">//                sb.append(getBorderStyle(3,cellStyle.getBorderLeft(), ((XSSFCellStyle) cellStyle).getLeftBorderXSSFColor()));</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(wb <span class="keyword">instanceof</span> HSSFWorkbook)&#123;</span><br><span class="line">HSSFFont hf = ((HSSFCellStyle) cellStyle).getFont((HSSFWorkbook) wb);</span><br><span class="line"><span class="keyword">boolean</span> boldWeight = hf.getBold();</span><br><span class="line"><span class="keyword">short</span> fontColor = hf.getColor();</span><br><span class="line">sb.append(<span class="string">"style='"</span>);</span><br><span class="line"> </span><br><span class="line">HSSFPalette palette = ((HSSFWorkbook) wb).getCustomPalette(); <span class="comment">// 类HSSFPalette用于求的颜色的国际标准形式</span></span><br><span class="line">HSSFColor hc = palette.getColor(fontColor);</span><br><span class="line"><span class="keyword">if</span>(boldWeight) &#123;</span><br><span class="line">sb.append(<span class="string">"font-weight:blod;"</span>); <span class="comment">// 字体加粗</span></span><br><span class="line">&#125;</span><br><span class="line">sb.append(<span class="string">"font-size: "</span> + hf.getFontHeight() / <span class="number">2</span> + <span class="string">"%;"</span>); <span class="comment">// 字体大小</span></span><br><span class="line">String fontColorStr = convertToStardColor(hc);</span><br><span class="line"><span class="keyword">if</span> (fontColorStr != <span class="keyword">null</span> &amp;&amp; !<span class="string">""</span>.equals(fontColorStr.trim())) &#123;</span><br><span class="line"><span class="keyword">if</span>(fontColorStr!=<span class="string">"#FFFFFF"</span>)&#123;</span><br><span class="line">sb.append(<span class="string">"color:"</span> + fontColorStr + <span class="string">";"</span>); <span class="comment">// 字体颜色</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">int</span> topRow = cell.getRowIndex(),topColumn = cell.getColumnIndex();</span><br><span class="line"><span class="keyword">if</span>(map[<span class="number">0</span>].containsKey(topRow + <span class="string">","</span> + topColumn))&#123;<span class="comment">//该单元格为合并单元格，宽度需要获取所有单元格宽度后合并</span></span><br><span class="line">String value = (String)map[<span class="number">0</span>].get(topRow + <span class="string">","</span> + topColumn);</span><br><span class="line">String[] ary = value.split(<span class="string">","</span>);</span><br><span class="line"><span class="keyword">int</span> bottomColumn = Integer.parseInt(ary[<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">if</span>(topColumn != bottomColumn)&#123;<span class="comment">//合并列，需要计算相应宽度</span></span><br><span class="line"><span class="keyword">int</span> columnWidth = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = topColumn; i &lt;= bottomColumn; i++)&#123;</span><br><span class="line">columnWidth += sheet.getColumnWidth(i);</span><br><span class="line">&#125;</span><br><span class="line">sb.append(<span class="string">"width:"</span> + columnWidth / <span class="number">256</span> * hf.getFontHeight() / <span class="number">20</span> + <span class="string">"pt;"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">int</span> columnWidth = sheet.getColumnWidth(cell.getColumnIndex()) ;</span><br><span class="line">sb.append(<span class="string">"width:"</span> + columnWidth / <span class="number">256</span> * hf.getFontHeight() / <span class="number">20</span> + <span class="string">"pt;"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">int</span> columnWidth = sheet.getColumnWidth(cell.getColumnIndex()) ;</span><br><span class="line">sb.append(<span class="string">"width:"</span> + columnWidth / <span class="number">256</span> * hf.getFontHeight() / <span class="number">20</span> + <span class="string">"pt;"</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">short</span> bgColor = cellStyle.getFillForegroundColor();</span><br><span class="line">hc = palette.getColor(bgColor);</span><br><span class="line">String bgColorStr = convertToStardColor(hc);</span><br><span class="line"><span class="keyword">if</span> (bgColorStr != <span class="keyword">null</span> &amp;&amp; !<span class="string">""</span>.equals(bgColorStr.trim())) &#123;</span><br><span class="line">sb.append(<span class="string">"background-color:"</span> + bgColorStr + <span class="string">";"</span>); <span class="comment">// 背景颜色</span></span><br><span class="line">&#125;</span><br><span class="line">sb.append(<span class="string">"border:solid #000000 1px;"</span>);</span><br><span class="line">&#125;</span><br><span class="line">sb.append(<span class="string">"' "</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 单元格内容的水平对齐方式</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> alignment</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">convertAlignToHtml</span><span class="params">(HorizontalAlignment alignment)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span>((HorizontalAlignment.CENTER).equals(alignment)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">"center"</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>((HorizontalAlignment.LEFT).equals(alignment)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">"left"</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>((HorizontalAlignment.RIGHT).equals(alignment)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">"right"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 单元格中内容的垂直排列方式</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> verticalAlignment</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">convertVerticalAlignToHtml</span><span class="params">(VerticalAlignment verticalAlignment)</span> </span>&#123;</span><br><span class="line">String valign = <span class="string">"middle"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>((VerticalAlignment.CENTER).equals(verticalAlignment)) &#123;</span><br><span class="line">valign = <span class="string">"center"</span>;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>((VerticalAlignment.BOTTOM).equals(verticalAlignment)) &#123;</span><br><span class="line">valign = <span class="string">"bottom"</span>;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>((VerticalAlignment.TOP).equals(verticalAlignment)) &#123;</span><br><span class="line"></span><br><span class="line">valign = <span class="string">"top"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> valign;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">convertToStardColor</span><span class="params">(HSSFColor hc)</span> </span>&#123;</span><br><span class="line">StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">""</span>);</span><br><span class="line"><span class="keyword">if</span> (hc != <span class="keyword">null</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (HSSFColor.AUTOMATIC.index == hc.getIndex()) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br><span class="line">sb.append(<span class="string">"#"</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; hc.getTriplet().length; i ++) &#123;</span><br><span class="line">sb.append(fillWithZero(Integer.toHexString(hc.getTriplet()[i])));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">fillWithZero</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (str != <span class="keyword">null</span> &amp;&amp; str.length() &lt; <span class="number">2</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">"0"</span> + str;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">static</span> String[] bordesr = &#123;<span class="string">"border-top:"</span>, <span class="string">"border-right:"</span>, <span class="string">"border-bottom:"</span>, <span class="string">"border-left:"</span>&#125;;</span><br><span class="line"><span class="keyword">static</span> String[] borderStyles = &#123;<span class="string">"solid "</span>, <span class="string">"solid "</span>, <span class="string">"solid "</span>, <span class="string">"solid "</span>, <span class="string">"solid "</span>, <span class="string">"solid "</span>, <span class="string">"solid "</span>, <span class="string">"solid "</span>, <span class="string">"solid "</span>, <span class="string">"solid"</span>, <span class="string">"solid"</span>, <span class="string">"solid"</span>, <span class="string">"solid"</span>, <span class="string">"solid"</span>&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@SuppressWarnings</span>(<span class="string">"unused"</span>)</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span>  String <span class="title">getBorderStyle</span><span class="params">(HSSFPalette palette , <span class="keyword">int</span> b, <span class="keyword">short</span> s, <span class="keyword">short</span> t)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(s == <span class="number">0</span>) <span class="keyword">return</span>  bordesr[b] + borderStyles[s] + <span class="string">"#d0d7e5 1px;"</span>;</span><br><span class="line">String borderColorStr = convertToStardColor( palette.getColor(t));</span><br><span class="line">borderColorStr = borderColorStr == <span class="keyword">null</span> || borderColorStr.length() &lt; <span class="number">1</span> ? <span class="string">"#000000"</span> : borderColorStr;</span><br><span class="line"><span class="keyword">return</span> bordesr[b] + borderStyles[s] + borderColorStr + <span class="string">" 1px;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@SuppressWarnings</span>(<span class="string">"unused"</span>)</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span>  String <span class="title">getBorderStyle</span><span class="params">(<span class="keyword">int</span> b, <span class="keyword">short</span> s, XSSFColor xc)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(s == <span class="number">0</span>)<span class="keyword">return</span>  bordesr[b] + borderStyles[s] + <span class="string">"#d0d7e5 1px;"</span>;</span><br><span class="line"><span class="keyword">if</span> (xc != <span class="keyword">null</span> &amp;&amp; ! <span class="string">""</span>.equals(xc)) &#123;</span><br><span class="line">String borderColorStr = xc.getARGBHex();<span class="comment">//t.getARGBHex();</span></span><br><span class="line">borderColorStr=borderColorStr == <span class="keyword">null</span> || borderColorStr.length() &lt; <span class="number">1</span> ? <span class="string">"#000000"</span> : borderColorStr.substring(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">return</span> bordesr[b] + borderStyles[s]+borderColorStr+<span class="string">" 1px;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@SuppressWarnings</span>(<span class="string">"unused"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeFile</span><span class="params">(String content, String path)</span> </span>&#123;</span><br><span class="line">OutputStream os = <span class="keyword">null</span>;</span><br><span class="line">BufferedWriter bw = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">File file = <span class="keyword">new</span> File(path);</span><br><span class="line"></span><br><span class="line">File fileParent = file.getParentFile();</span><br><span class="line"><span class="keyword">if</span>(!fileParent.exists())&#123;</span><br><span class="line">    fileParent.mkdir();</span><br><span class="line">&#125;</span><br><span class="line">os = <span class="keyword">new</span> FileOutputStream(file);</span><br><span class="line">bw = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(os,<span class="string">"GBK"</span>));</span><br><span class="line">bw.write(content);</span><br><span class="line">&#125; <span class="keyword">catch</span> (FileNotFoundException fnfe) &#123;</span><br><span class="line">fnfe.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException ioe) &#123;</span><br><span class="line">ioe.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">null</span> != bw)</span><br><span class="line">bw.close();</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">null</span> != os)</span><br><span class="line">os.close();</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException ie) &#123;</span><br><span class="line">ie.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span>[] getColsOfTable(Sheet sheet) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span>[] data = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = sheet.getFirstRowNum(); i &lt; sheet.getLastRowNum(); i ++) &#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">null</span> != sheet.getRow(i)) &#123;</span><br><span class="line">data[<span class="number">0</span>] = sheet.getRow(i).getLastCellNum();</span><br><span class="line">data[<span class="number">1</span>] = sheet.getRow(i).getHeight();</span><br><span class="line">&#125;<span class="keyword">else</span> </span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">CreatIndexHtml</span><span class="params">(ArrayList&lt;String&gt; labers)</span></span>&#123;</span><br><span class="line">StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">sb.append(<span class="string">"&lt;style&gt;tbody &#123;margin-bottom: 0px;margin-top: 0px;margin-right: 0px;margin-left: 0px;background-color: rgb(128, 128, 128);&#125;table &#123;border-top-width: 0px;border-right-width: 0px;border-bottom-width: 0px;border-left-width: 0px;&#125; .exclbtn&#123;display: inline-block;margin-bottom: 0;font-weight: normal;text-align: center;vertical-align: middle;cursor: pointer;background-image: none;border: 1px solid transparent;white-space: nowrap;padding: 0px 2px;font-size: 14px;line-height: 1.428571429;border-radius: 2px;&#125;"</span>)</span><br><span class="line">  .append(<span class="string">"&lt;/style&gt;&lt;body topmargin='0' leftmargin='0' marginwidth='0' marginheight='0' &gt;&lt;div&gt;&lt;iframe id='InlayReportView' src='sheet0.htm' frameborder='0' width='100%' height='100%'&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;div style='position: fixed;bottom: 0px;"</span>)</span><br><span class="line">  .append(<span class="string">"left: 0px;font-size: 0;line-height: 0;z-index: 100;width:100%;background-color:#808080;height: 30px;'&gt;&lt;table border='0' cellspacing='1' id='footlaber'&gt;&lt;tbody&gt;&lt;tr&gt;"</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;labers.size();i++)&#123;</span><br><span class="line">sb.append(<span class="string">"&lt;td&gt;&lt;button style=\"background-color:white;\" class=\"exclbtn\" onclick=\"changeSrc('sheet"</span>);</span><br><span class="line">sb.append(i);</span><br><span class="line">sb.append(<span class="string">"')\" value=\"sheet"</span>);</span><br><span class="line">sb.append(i);</span><br><span class="line">sb.append(<span class="string">"\"&gt;"</span>);</span><br><span class="line">sb.append(labers.get(i));</span><br><span class="line">sb.append(<span class="string">"&lt;/button&gt;&lt;/td&gt;"</span>);</span><br><span class="line">&#125;</span><br><span class="line">sb.append(<span class="string">"&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;&lt;/body&gt;&lt;script&gt;function changeSrc(url)&#123;var src = url+'.htm';document.getElementById('InlayReportView').src=src;var labers = document.getElementById(\"footlaber\").getElementsByTagName(\"button\");for(var i=0;i&lt;labers.length;i++)&#123;var value = labers[i].getAttribute('value');if(value == url)&#123;labers[i].setAttribute('style','background-color:#985159;color:white');&#125;else&#123;labers[i].setAttribute('style','background-color:white')&#125;&#125;&#125;&lt;/script&gt;"</span>);</span><br><span class="line">System.out.println(sb.toString());</span><br><span class="line"><span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-功能优化-2019-01-07-利用APS将excel转换成html"><a href="#6-功能优化-2019-01-07-利用APS将excel转换成html" class="headerlink" title="6.功能优化(2019-01-07),利用APS将excel转换成html"></a>6.功能优化(2019-01-07),利用APS将excel转换成html</h3><p>APS.cells for java 将excel转换成html的功能非常强大，几乎和使用office另存为html效果一样，但是此jar包是收费产品。测试版页面会有水印(想要破解使用的话据说是要解决监听问题，本人技术有限，只能对转完之后的html文件进行二次处理…)；<br>1.引入相关jar包，官网上会有用法，这里直接给出配置文件，maven可以自动下载（附加jsoup解析）<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>AsposeJavaAPI<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>Aspose Java API<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://artifact.aspose.com/repo/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- jsoup解析xml文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.jsoup<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsoup<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.8.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.aspose<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspose-cells<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>18.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>2.转换excel为html，并进行二次处理，去水印，将最后一个多余sheet复制为第一个sheet页，瞒天过海。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ApsToHtml</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">Date date = <span class="keyword">new</span> Date();</span><br><span class="line">System.out.println(System.currentTimeMillis());</span><br><span class="line">Workbook wb = <span class="keyword">new</span> Workbook(<span class="string">"C:\\Users\\x_panrui\\Desktop\\test.xlsx"</span>);</span><br><span class="line">FileOutputStream out = <span class="keyword">new</span> FileOutputStream(file);</span><br><span class="line"><span class="comment">//这里是执行excel中所包含的公式，如果不加的话含有公式的单元格会没有数值</span></span><br><span class="line">wb.calculateFormula(<span class="keyword">true</span>);</span><br><span class="line">wb.save(<span class="string">"C:\\Users\\x_panrui\\Desktop\\test.htm"</span>, SaveFormat.HTML);</span><br><span class="line">System.out.println(System.currentTimeMillis());</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//破解Aps工具包</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pojieAps</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//生成之后的底部sheet页导航栏文件</span></span><br><span class="line">String url = <span class="string">"C:\\Users\\x_panrui\\Desktop\\test_files\\tabstrip.htm"</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">File input = <span class="keyword">new</span> File(url);</span><br><span class="line"><span class="comment">//这里如果用UTF-8乱码可换成gbk试一下</span></span><br><span class="line">Document doc = Jsoup.parse(input, <span class="string">"UTF-8"</span>, <span class="string">"http://example.com/"</span>);</span><br><span class="line">Elements  elements =doc.select(<span class="string">"table"</span>);</span><br><span class="line"><span class="comment">//要删除连接的地址</span></span><br><span class="line">String href = <span class="keyword">null</span>;</span><br><span class="line"><span class="comment">//获取节点name</span></span><br><span class="line">Elements tds = elements.select(<span class="string">"td"</span>);</span><br><span class="line"><span class="comment">//tds.remove(tds.size());</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;tds.size();i++) &#123;</span><br><span class="line">Element tdels = tds.get(i);</span><br><span class="line"><span class="comment">//如果是最后一个则删除此sheet页</span></span><br><span class="line"><span class="keyword">if</span>(i == (tds.size()-<span class="number">1</span>)) &#123;</span><br><span class="line">href  = tdels.select(<span class="string">"a"</span>).get(<span class="number">0</span>).attr(<span class="string">"href"</span>);</span><br><span class="line">tdels.remove();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//更改编码格式 （源文件是gbk的但是显示出来乱码，前面jsoup采用gbk格式也一样乱码，所以将源文件更改成了utf-8，之后就好了）</span></span><br><span class="line">Elements meta = doc.select(<span class="string">"meta"</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>;k&lt;meta.size();k++) &#123;</span><br><span class="line">Element metaObj = meta.get(k);</span><br><span class="line">String charset = metaObj.attr(<span class="string">"content"</span>);</span><br><span class="line"><span class="keyword">if</span>(charset.contains(<span class="string">"charset"</span>)) &#123;</span><br><span class="line">metaObj.attr(<span class="string">"content"</span>,<span class="string">"text/html; charset=utf-8"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">FileOutputStream docfos = <span class="keyword">new</span> FileOutputStream(input, <span class="keyword">false</span>);  </span><br><span class="line">            OutputStreamWriter docosw = <span class="keyword">new</span> OutputStreamWriter(docfos, <span class="string">"UTF-8"</span>);  </span><br><span class="line">            docosw.write(doc.html());  </span><br><span class="line">            docosw.close();  </span><br><span class="line"><span class="comment">//删除最后一个水印</span></span><br><span class="line">String deteleHtm = url.substring(<span class="number">0</span>,url.lastIndexOf(<span class="string">"\\"</span>)) + <span class="string">"\\"</span> + href;</span><br><span class="line">File file = <span class="keyword">new</span> File(deteleHtm);</span><br><span class="line">file.delete();</span><br><span class="line">            </span><br><span class="line">           <span class="comment">//每一个sheet文件中都会存在水印，是通过JavaScript写上去的，去掉这句话就不会有水印了</span></span><br><span class="line">File allFiles = <span class="keyword">new</span> File(url.substring(<span class="number">0</span>,url.lastIndexOf(<span class="string">"\\"</span>)));</span><br><span class="line">File[] files = allFiles.listFiles();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> y = <span class="number">0</span>;y&lt;files.length;y++) &#123;</span><br><span class="line">File sheet = files[y];</span><br><span class="line"><span class="keyword">if</span>(sheet.getName().startsWith(<span class="string">"sheet"</span>)) &#123;</span><br><span class="line">System.out.println(sheet.getName());</span><br><span class="line">Document sheetDoc = Jsoup.parse(sheet, <span class="string">"UTF-8"</span>, <span class="string">"http://example.com/"</span>);</span><br><span class="line">Elements js = sheetDoc.select(<span class="string">"script"</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> h =<span class="number">0</span>;h&lt;js.size();h++) &#123;</span><br><span class="line">Element script = js.get(h);</span><br><span class="line">String javascripte = script.html();</span><br><span class="line"><span class="keyword">if</span>(javascripte.startsWith(<span class="string">"document"</span>)) &#123;</span><br><span class="line">script.html(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(sheet, <span class="keyword">false</span>);  </span><br><span class="line">OutputStreamWriter osw = <span class="keyword">new</span> OutputStreamWriter(fos, <span class="string">"UTF-8"</span>);</span><br><span class="line">osw.write(sheetDoc.html());</span><br><span class="line">osw.close();  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">String oldurl = url.substring(<span class="number">0</span>,url.lastIndexOf(<span class="string">"\\"</span>)+<span class="number">1</span>)+<span class="string">"sheet001.htm"</span>;</span><br><span class="line">String newhref = url.substring(<span class="number">0</span>,url.lastIndexOf(<span class="string">"\\"</span>)+<span class="number">1</span>) + href;</span><br><span class="line">FileCommentUtils.copyOldFile(oldurl, newhref);</span><br><span class="line"><span class="comment">//</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line"><span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//那啥复制文件的代码</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">copyOldFile</span><span class="params">(String oldurl,String newurl)</span> </span>&#123;</span><br><span class="line"><span class="keyword">boolean</span> flag = <span class="keyword">false</span>;</span><br><span class="line">File oldFile = <span class="keyword">new</span> File(oldurl);</span><br><span class="line">FileChannel input = <span class="keyword">null</span>;</span><br><span class="line">FileChannel output = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(oldFile.exists()) &#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">input = <span class="keyword">new</span> FileInputStream(oldurl).getChannel();</span><br><span class="line">output = <span class="keyword">new</span> FileOutputStream(newurl).getChannel();</span><br><span class="line">output.transferFrom(input, <span class="number">0</span>, input.size());</span><br><span class="line">input.close();</span><br><span class="line">output.close();</span><br><span class="line">&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;使用poi根据模板生成excel&quot;&gt;&lt;a href=&quot;#使用poi根据模板生成excel&quot; class=&quot;headerlink&quot; title=&quot;使用poi根据模板生成excel&quot;&gt;&lt;/a&gt;使用poi根据模板生成excel&lt;/h2&gt;&lt;h3 id=&quot;1-导入相关jar
      
    
    </summary>
    
    
      <category term="Java" scheme="https://panruipr.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>linux服务器安装vsfpd服务，使用java上传文件至ftp服务器</title>
    <link href="https://panruipr.github.io/2018/10/09/vsfpdAndFtpUpload/"/>
    <id>https://panruipr.github.io/2018/10/09/vsfpdAndFtpUpload/</id>
    <published>2018-10-09T05:21:28.000Z</published>
    <updated>2019-01-07T12:11:07.942Z</updated>
    
    <content type="html"><![CDATA[<p>##　Linux服务器中安装vsfpd服务，并使用java基于ftp传输协议实现文件上传</p><h3 id="1-在服务器上安装vsftpd（那啥自行百度搜索-有时间再补充）"><a href="#1-在服务器上安装vsftpd（那啥自行百度搜索-有时间再补充）" class="headerlink" title="1.在服务器上安装vsftpd（那啥自行百度搜索,有时间再补充）"></a>1.在服务器上安装vsftpd（那啥自行百度搜索,有时间再补充）</h3><h3 id="2-使用java代码实现文件上传"><a href="#2-使用java代码实现文件上传" class="headerlink" title="2.使用java代码实现文件上传"></a>2.使用java代码实现文件上传</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将本地文件上传至ftp</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">FTPClient ftp = <span class="keyword">new</span> FTPClient();</span><br><span class="line">InputStream in = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//连接ftp服务器，地址，记得防火墙开端口</span></span><br><span class="line">ftp.connect(<span class="string">"xxx.xxx.xxx.xxx"</span>,<span class="number">21</span>);</span><br><span class="line"><span class="comment">//登陆（用户名。密码）</span></span><br><span class="line">ftp.login(<span class="string">"test"</span>, <span class="string">"123456"</span>);</span><br><span class="line"><span class="comment">//设置上传路径</span></span><br><span class="line">String path=<span class="string">"/home/panrui/ftp"</span>;</span><br><span class="line"><span class="comment">//检查路径是否存在</span></span><br><span class="line"><span class="keyword">boolean</span> flage = ftp.changeWorkingDirectory(path);</span><br><span class="line"><span class="keyword">if</span>(!flage) &#123;</span><br><span class="line">ftp.makeDirectory(path);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//设置上传文件路径</span></span><br><span class="line">ftp.changeWorkingDirectory(path);</span><br><span class="line"><span class="comment">//设置上传文件类型(为二进制)</span></span><br><span class="line">ftp.setFileType(FTP.BINARY_FILE_TYPE);</span><br><span class="line">File file = <span class="keyword">new</span> File(<span class="string">"C:\\Users\\x_panrui\\Desktop\\文件\\工作文档\\笔记\\PoiCreateExcel.md"</span>);</span><br><span class="line">in = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">ftp.enterLocalPassiveMode();</span><br><span class="line"><span class="keyword">boolean</span> result = ftp.storeFile(file.getName(), in);</span><br><span class="line">System.out.println(<span class="string">"返回结果::"</span> + result);</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">in.close();</span><br><span class="line">ftp.logout();</span><br><span class="line">ftp.disconnect();</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e2) &#123;</span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;##　Linux服务器中安装vsfpd服务，并使用java基于ftp传输协议实现文件上传&lt;/p&gt;
&lt;h3 id=&quot;1-在服务器上安装vsftpd（那啥自行百度搜索-有时间再补充）&quot;&gt;&lt;a href=&quot;#1-在服务器上安装vsftpd（那啥自行百度搜索-有时间再补充）&quot; cl
      
    
    </summary>
    
    
      <category term="Java" scheme="https://panruipr.github.io/tags/Java/"/>
    
      <category term="Linux" scheme="https://panruipr.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>java线程池的简单使用笔记</title>
    <link href="https://panruipr.github.io/2018/10/08/ThreadPool/"/>
    <id>https://panruipr.github.io/2018/10/08/ThreadPool/</id>
    <published>2018-10-08T07:02:20.000Z</published>
    <updated>2018-10-19T09:18:34.705Z</updated>
    
    <content type="html"><![CDATA[<h2 id="java线程池的简单使用以及自己的理解"><a href="#java线程池的简单使用以及自己的理解" class="headerlink" title="java线程池的简单使用以及自己的理解"></a>java线程池的简单使用以及自己的理解</h2><p>线程池，装线程的池子。管理线程，如果池子中有空闲的线程，则可以直接拿来用，避免重复创建线程，销毁线程，浪费资源。尤其是在并发量比交高的时候，也可以一定程度上控制数据库连接数。</p><h3 id="1-创建线程池"><a href="#1-创建线程池" class="headerlink" title="1.创建线程池"></a>1.创建线程池</h3><p>建议使用单例模式创建线程池，一个程序中线程池存在一个比较好，感觉使用多个线程池和多线程差不多了，意义不大。使用一个线程池，线程最大连接数量可以固定不会超出峰值。<br>创建线程池有多种方法，这里不深究，对参数做下说明：</p><table><thead><tr><th>参数名称</th><th>参数说明</th></tr></thead><tbody><tr><td>corePoolSize</td><td>核心连接数</td></tr><tr><td>maximumPoolSize</td><td>最大连接数</td></tr><tr><td>keepAliveTime</td><td>空闲时间</td></tr><tr><td>unit</td><td>时间类型</td></tr><tr><td>workQueue</td><td>阻塞式任务队列</td></tr></tbody></table><p>正在执行的线程最多为线程池的最大连接数，一但超过最大连接数，将会进入阻塞式任务队列中，等待当前线程执行完再执行任务，任务队列中有个数值，等待执行的任务数。一般建议是使用LinkedBlockingQueue，据说拥有比ArrayBlockingQueue更高的吞吐量。稳定性不太好，具体没研究</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.ArrayBlockingQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ThreadPoolExecutor;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SinglePoolThread</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> ThreadPoolExecutor executor = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="title">SinglePoolThread</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// TODO 自动生成的构造函数存根</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span>  ThreadPoolExecutor <span class="title">getInstacnce</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">synchronized</span>(SinglePoolThread.class)&#123;</span><br><span class="line"><span class="keyword">if</span>(executor==<span class="keyword">null</span>)&#123;</span><br><span class="line">executor = <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">4</span>, <span class="number">5</span>, <span class="number">200</span>, TimeUnit.MILLISECONDS, <span class="keyword">new</span> ArrayBlockingQueue&lt;Runnable&gt;(<span class="number">100</span>));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> executor;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-创建线程类"><a href="#2-创建线程类" class="headerlink" title="2.创建线程类"></a>2.创建线程类</h3><p>创建线程实现Runable接口或者继承Thread类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadDemo</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ThreadDemo</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">updatePushReport();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span>  <span class="keyword">synchronized</span>  <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">updatePushReport</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//逻辑代码</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadDemo</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"><span class="keyword">super</span>.run();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-使用线程池的execute方法执行线城实例"><a href="#3-使用线程池的execute方法执行线城实例" class="headerlink" title="3.使用线程池的execute方法执行线城实例"></a>3.使用线程池的execute方法执行线城实例</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ThreadDemo threadDemo = <span class="keyword">new</span> ThreadDemo();</span><br><span class="line">excExecutor.execute(threadDemo);</span><br><span class="line">System.out.println(<span class="string">"线程池中线程数目："</span>+excExecutor.getPoolSize()+<span class="string">"，队列中等待执行的任务数目："</span>+</span><br><span class="line">excExecutor.getQueue().size()+<span class="string">"，已执行玩别的任务数目："</span>+excExecutor.getCompletedTaskCount());</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;java线程池的简单使用以及自己的理解&quot;&gt;&lt;a href=&quot;#java线程池的简单使用以及自己的理解&quot; class=&quot;headerlink&quot; title=&quot;java线程池的简单使用以及自己的理解&quot;&gt;&lt;/a&gt;java线程池的简单使用以及自己的理解&lt;/h2&gt;&lt;p&gt;线程
      
    
    </summary>
    
    
      <category term="Java" scheme="https://panruipr.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>使用java中的email工具类发送邮件</title>
    <link href="https://panruipr.github.io/2018/10/08/sendEmail/"/>
    <id>https://panruipr.github.io/2018/10/08/sendEmail/</id>
    <published>2018-10-08T05:21:07.000Z</published>
    <updated>2018-10-09T05:23:44.257Z</updated>
    
    <content type="html"><![CDATA[<h2 id="使用java工具类email基于smpt（简单邮件传输协议）实现邮件发送"><a href="#使用java工具类email基于smpt（简单邮件传输协议）实现邮件发送" class="headerlink" title="使用java工具类email基于smpt（简单邮件传输协议）实现邮件发送"></a>使用java工具类email基于smpt（简单邮件传输协议）实现邮件发送</h2><h3 id="1-设置session属性"><a href="#1-设置session属性" class="headerlink" title="1.设置session属性"></a><strong>1.设置session属性</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置属性</span></span><br><span class="line">Properties prop = <span class="keyword">new</span> Properties();</span><br><span class="line">prop.setProperty(<span class="string">"mail.host"</span>,<span class="string">"xxxx.com"</span>);<span class="comment">//使用邮件服务器</span></span><br><span class="line">prop.setProperty(<span class="string">"mail.transport.protocol"</span>, <span class="string">"smtp"</span>);<span class="comment">//协议为SMPT协议</span></span><br><span class="line">prop.setProperty(<span class="string">"mail.smtp.auth"</span>, <span class="string">"true"</span>);<span class="comment">//是否需要验证</span></span><br></pre></td></tr></table></figure><h3 id="2-获取session对象"><a href="#2-获取session对象" class="headerlink" title="2.获取session对象"></a><strong>2.获取session对象</strong></h3><p>获取session对象这里有两中方式Session.getInstance(prop)和Session.getInstance(props, authenticator);</p><h6 id="1-Session-getInstance-prop-。（本文以这种方式连接，貌似没有授权）"><a href="#1-Session-getInstance-prop-。（本文以这种方式连接，貌似没有授权）" class="headerlink" title="1.Session.getInstance(prop)。（本文以这种方式连接，貌似没有授权）"></a><em>1.Session.getInstance(prop)。（本文以这种方式连接，貌似没有授权）</em></h6><p>使用这种方式需要获取Transport对象调用connect方法；</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Session session = Session.getInstance(prop);</span><br><span class="line"><span class="comment">//开启Session的debug模式，这样就可以查看到程序发送Email的运行状态</span></span><br><span class="line">session.setDebug(<span class="keyword">true</span>);</span><br><span class="line"><span class="comment">//2、通过session得到transport对象</span></span><br><span class="line">Transport ts = session.getTransport();</span><br><span class="line"><span class="comment">//3、使用邮箱的用户名和密码连上邮件服务器，发送邮件时，发件人需要提交邮箱的用户名和密码给smtp服务器，用户名和密码都通过验证之后才能够正常发送邮件给收件人。</span></span><br><span class="line">ts.connect(<span class="string">"xxxx.com"</span>, <span class="string">"user"</span>,<span class="string">"password"</span>);</span><br><span class="line"><span class="comment">//ts.connect("xxxx.com","port", "user","password");带服务器端口</span></span><br></pre></td></tr></table></figure><h6 id="2-Session-getInstance-props-authenticator-（授权信息）"><a href="#2-Session-getInstance-props-authenticator-（授权信息）" class="headerlink" title="2.Session.getInstance(props, authenticator);（授权信息）"></a><em>2.Session.getInstance(props, authenticator);（授权信息）</em></h6><p>在创建邮件会话的时候将授权信息带进去</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">prop.setProperty(<span class="string">"mail.user"</span>, <span class="string">"xxxxxxx@qq.com"</span>);<span class="comment">//用户名</span></span><br><span class="line">prop.setProperty(<span class="string">"mail.password"</span>, <span class="string">"xxxxxxxxxxxxxxxxxxx"</span>);<span class="comment">//授权码</span></span><br><span class="line"><span class="comment">// 构建授权信息，用于进行SMTP进行身份验证</span></span><br><span class="line">Authenticator authenticator = <span class="keyword">new</span> Authenticator() &#123;</span><br><span class="line"><span class="function"><span class="keyword">protected</span> PasswordAuthentication <span class="title">getPasswordAuthentication</span><span class="params">()</span> </span>&#123;</span><br><span class="line">         String userName = prop.getProperty(<span class="string">"mail.user"</span>);</span><br><span class="line">         String password = prop.getProperty(<span class="string">"mail.password"</span>);</span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">new</span> PasswordAuthentication(userName, password);</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;;</span><br><span class="line"> <span class="comment">// 使用环境属性和授权信息，创建邮件会话</span></span><br><span class="line"> Session mailSession = Session.getInstance(prop, authenticator);</span><br></pre></td></tr></table></figure><h3 id="3-往邮件中填充内容"><a href="#3-往邮件中填充内容" class="headerlink" title="3.往邮件中填充内容"></a>3.往邮件中填充内容</h3><p>创建邮件对象Message，多重消息使用Multipart对象，使用addBodyPart（）方法添加多重消息体，最后将多重消息放进Message的Content属性中。完整代码如下，<strong>需要注意的是附件中文名称需要用MimeUtility解码</strong></p><p>这里由于服务器路径文件名是中文转码后的随机数，但是发送附件需要中文，所以自己做了处理，内容也是用对象传递过来的。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.activation.DataHandler;</span><br><span class="line"><span class="keyword">import</span> javax.activation.DataSource;</span><br><span class="line"><span class="keyword">import</span> javax.activation.FileDataSource;</span><br><span class="line"><span class="keyword">import</span> javax.mail.BodyPart;</span><br><span class="line"><span class="keyword">import</span> javax.mail.Message;</span><br><span class="line"><span class="keyword">import</span> javax.mail.Multipart;</span><br><span class="line"><span class="keyword">import</span> javax.mail.Session;</span><br><span class="line"><span class="keyword">import</span> javax.mail.Transport;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.InternetAddress;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.MimeBodyPart;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.MimeMessage;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.MimeMultipart;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.MimeUtility;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sendEmail</span><span class="params">(JSONObject mailInfo)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"><span class="comment">//设置属性</span></span><br><span class="line">Properties prop = <span class="keyword">new</span> Properties();</span><br><span class="line">    prop.setProperty(<span class="string">"mail.host"</span>, mailInfo.getString(<span class="string">"smtpHost"</span>));</span><br><span class="line">    prop.setProperty(<span class="string">"mail.transport.protocol"</span>, <span class="string">"smtp"</span>);</span><br><span class="line">    prop.setProperty(<span class="string">"mail.smtp.auth"</span>, <span class="string">"true"</span>);</span><br><span class="line">    <span class="comment">//使用JavaMail发送邮件的5个步骤</span></span><br><span class="line">    <span class="comment">//1、创建session</span></span><br><span class="line">    Session session = Session.getInstance(prop);</span><br><span class="line">    <span class="comment">//开启Session的debug模式，这样就可以查看到程序发送Email的运行状态</span></span><br><span class="line">    session.setDebug(<span class="keyword">true</span>);</span><br><span class="line">    <span class="comment">//2、通过session得到transport对象</span></span><br><span class="line">    Transport ts = session.getTransport();</span><br><span class="line">    <span class="comment">//3、使用邮箱的用户名和密码连上邮件服务器，发送邮件时，发件人需要提交邮箱的用户名和密码给smtp服务器，用户名和密码都通过验证之后才能够正常发送邮件给收件人。</span></span><br><span class="line">    ts.connect(mailInfo.getString(<span class="string">"smtpHost"</span>), mailInfo.getString(<span class="string">"userName"</span>), mailInfo.getString(<span class="string">"password"</span>));</span><br><span class="line">    <span class="comment">//4、创建邮件</span></span><br><span class="line">    MimeMessage message = <span class="keyword">new</span> MimeMessage(session);</span><br><span class="line">    <span class="comment">//设置发件箱</span></span><br><span class="line">    message.setFrom(<span class="keyword">new</span> InternetAddress(mailInfo.getString(<span class="string">"from"</span>)));</span><br><span class="line">    <span class="comment">//设置主题</span></span><br><span class="line">    message.setSubject(mailInfo.getString(<span class="string">"subject"</span>));</span><br><span class="line">    <span class="comment">//设置收件人</span></span><br><span class="line">    List&lt;String&gt; recivePersons = mailInfo.getList(<span class="string">"to"</span>);</span><br><span class="line">    System.out.println(<span class="string">"recive Person address:"</span> + recivePersons.toString());</span><br><span class="line">    InternetAddress[] reciveAddress = <span class="keyword">new</span> InternetAddress[recivePersons.size()];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span>;i&lt;recivePersons.size();i++)&#123;</span><br><span class="line">    reciveAddress[i] = <span class="keyword">new</span> InternetAddress(recivePersons.get(i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//设置抄送人</span></span><br><span class="line">    List&lt;String&gt; ccPerson = mailInfo.getList(<span class="string">"cc"</span>);</span><br><span class="line">    InternetAddress[] ccPersonAddress = <span class="keyword">new</span> InternetAddress[ccPerson.size()];</span><br><span class="line">    <span class="keyword">if</span>(ccPerson!=<span class="keyword">null</span>)&#123;</span><br><span class="line">     <span class="keyword">for</span>(<span class="keyword">int</span> j =<span class="number">0</span>;j&lt;ccPerson.size();j++)&#123;</span><br><span class="line">        ccPersonAddress[j] = <span class="keyword">new</span> InternetAddress(ccPerson.get(j));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    message.setRecipients(Message.RecipientType.TO, reciveAddress);</span><br><span class="line">    message.setRecipients(Message.RecipientType.CC, ccPersonAddress);</span><br><span class="line">    <span class="comment">//多重消息</span></span><br><span class="line">    Multipart multipart = <span class="keyword">new</span> MimeMultipart();</span><br><span class="line">    <span class="comment">//正文</span></span><br><span class="line">    BodyPart messageBodyPart = <span class="keyword">new</span> MimeBodyPart();</span><br><span class="line">    messageBodyPart.setText(mailInfo.getString(<span class="string">"message"</span>));</span><br><span class="line">    multipart.addBodyPart(messageBodyPart);</span><br><span class="line">    <span class="comment">//附件</span></span><br><span class="line">    List&lt;String&gt; attachFilePaths = mailInfo.getList(<span class="string">"attachFilePaths"</span>);</span><br><span class="line">    <span class="keyword">if</span>(attachFilePaths!=<span class="keyword">null</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> y=<span class="number">0</span>;y&lt;attachFilePaths.size();y++)&#123;</span><br><span class="line">            System.out.println(attachFilePaths.get(y).toString());</span><br><span class="line">            String[] fileInfo = attachFilePaths.get(y).split(<span class="string">";"</span>);</span><br><span class="line">            BodyPart attachFileBodyPart = <span class="keyword">new</span> MimeBodyPart();</span><br><span class="line">            <span class="comment">//将文件路径转换成数据源</span></span><br><span class="line">            DataSource dataSource = <span class="keyword">new</span> FileDataSource(fileInfo[<span class="number">0</span>]);</span><br><span class="line">            attachFileBodyPart.setDataHandler(<span class="keyword">new</span> DataHandler(dataSource));</span><br><span class="line">            <span class="keyword">if</span>(StringUtils.isNotBlank(fileInfo[<span class="number">1</span>]))&#123;</span><br><span class="line">            <span class="comment">//这里需要用MimeUtility来将附件中文名称进行解码,以防止附件名称出现乱码的问题</span></span><br><span class="line">  attachFileBodyPart.setFileName(MimeUtility.encodeWord(fileInfo[<span class="number">1</span>]+fileInfo[<span class="number">0</span>].substring(fileInfo[<span class="number">0</span>].lastIndexOf(<span class="string">"."</span>),fileInfo[<span class="number">0</span>].length())));</span><br><span class="line">            &#125;</span><br><span class="line">            multipart.addBodyPart(attachFileBodyPart);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    message.setContent(multipart);</span><br><span class="line">    <span class="comment">//5、发送邮件</span></span><br><span class="line">    ts.sendMessage(message, message.getAllRecipients());</span><br><span class="line">    <span class="comment">//6、关闭连接</span></span><br><span class="line">    ts.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;使用java工具类email基于smpt（简单邮件传输协议）实现邮件发送&quot;&gt;&lt;a href=&quot;#使用java工具类email基于smpt（简单邮件传输协议）实现邮件发送&quot; class=&quot;headerlink&quot; title=&quot;使用java工具类email基于smpt
      
    
    </summary>
    
    
      <category term="Java" scheme="https://panruipr.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Hexo+gitHub搭建个人博客</title>
    <link href="https://panruipr.github.io/2018/06/05/Hexo-gitHub/"/>
    <id>https://panruipr.github.io/2018/06/05/Hexo-gitHub/</id>
    <published>2018-06-05T08:31:18.000Z</published>
    <updated>2018-10-19T08:56:46.103Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Hexo-gitHub搭建个人博客，linux系统为centOs7"><a href="#Hexo-gitHub搭建个人博客，linux系统为centOs7" class="headerlink" title="Hexo+gitHub搭建个人博客，linux系统为centOs7"></a>Hexo+gitHub搭建个人博客，linux系统为centOs7</h2><h3 id="1-安装Node-js"><a href="#1-安装Node-js" class="headerlink" title="1.安装Node.js"></a>1.安装Node.js</h3><h5 id="1-下载并安装解压到当前文件夹"><a href="#1-下载并安装解压到当前文件夹" class="headerlink" title="1.下载并安装解压到当前文件夹"></a>1.下载并安装解压到当前文件夹</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">uname -a  #查看linuxs服务版本信息;</span><br><span class="line">wget https://nodejs.org/dist/v8.11.2/node-v8.11.2-linux-x64.tar.xz 下载安装包</span><br><span class="line">tar -xvf node-v8.11.2-linux-x64.tar.xz    #解压</span><br><span class="line">mv node-v8.11.2-linux-x64.tar.xz  node-v8.11.2  #更名</span><br><span class="line">cd node-v8.11.2  </span><br><span class="line">pwd #获取当前目录路径</span><br></pre></td></tr></table></figure><h5 id="2-配置环境变量-和配置java环境变量差不多"><a href="#2-配置环境变量-和配置java环境变量差不多" class="headerlink" title="2.配置环境变量(和配置java环境变量差不多)"></a>2.配置环境变量(和配置java环境变量差不多)</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br><span class="line">NODE_HOME=/home/xxxx/node-v8.11.2  #添加node的路径</span><br><span class="line">path = :$NODE_HOME/bin#在path中添加=后面的代码</span><br><span class="line">export NODE_HOME#导入路径</span><br><span class="line">source profile  #之后执行命令重启配置文件</span><br></pre></td></tr></table></figure><h5 id="3-检查nodejs是否安装成功"><a href="#3-检查nodejs是否安装成功" class="headerlink" title="3. 检查nodejs是否安装成功"></a>3. 检查nodejs是否安装成功</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node -v    #出现版本信息就证明安装成功</span><br></pre></td></tr></table></figure><h3 id="2-安装hexo和git"><a href="#2-安装hexo和git" class="headerlink" title="2.安装hexo和git"></a>2.安装hexo和git</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir Hexo</span><br><span class="line">cd Hexo</span><br><span class="line">yum install git-core  #安装git并安装依赖包</span><br><span class="line">npm install -g hexo-cli #安装Hexo</span><br><span class="line">hexo init  #初始化Hexo</span><br></pre></td></tr></table></figure><h3 id="3-安装插件"><a href="#3-安装插件" class="headerlink" title="3.安装插件"></a>3.安装插件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-index --save</span><br><span class="line">npm install hexo-generator-archive --save </span><br><span class="line">npm install hexo-generator-category --save </span><br><span class="line">npm install hexo-generator-tag --save </span><br><span class="line">npm install hexo-server --save </span><br><span class="line">npm install hexo-deployer-git --save </span><br><span class="line">npm install hexo-deployer-heroku --save </span><br><span class="line">npm install hexo-deployer-rsync --save </span><br><span class="line">npm install hexo-deployer-openshift --save </span><br><span class="line">npm install hexo-renderer-marked --save </span><br><span class="line">npm install hexo-renderer-stylus --save </span><br><span class="line">npm install hexo-generator-feed --save </span><br><span class="line">npm install hexo-generator-sitemap --save</span><br></pre></td></tr></table></figure><p>注意：插件必须要安装，不然之后执行命令的时候会报错：没有相关的指令，还有就是安装插件的时候必须在，Hexo文件目录下才能执行。有关Hexo的命令也都是在这个文件目录下执行。</p><p>启动hexo服务</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>测试是否成功，在浏览器种范文locahost:4000默认端口是4000.如果是云服务就ip+port</p><h3 id="3-配置github-上传代码到git"><a href="#3-配置github-上传代码到git" class="headerlink" title="3.配置github 上传代码到git"></a>3.配置github 上传代码到git</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">cd ~/. ssh #检查本机是否存在的shh密钥</span><br><span class="line">ssh-keygen -t -rsa -C ”邮件地址“ #生成ssh密钥，执行一下代码</span><br><span class="line">cat ~/.ssh/id_rsa.pub #找到密钥存放地址</span><br><span class="line">vim _config.yml #配置hexo的配置文件</span><br><span class="line">      deploy:</span><br><span class="line">       type: git</span><br><span class="line">       repository: git@github.com:panruipr/panruipr.github.io.git</span><br><span class="line">       branch: master</span><br><span class="line"><span class="meta">   #</span><span class="bash">这里最好复制粘贴不要手打，冒号后面一定要跟一个空格，不然上传的时候没有任何反应，没有报错，代码也上传不成功,坑了我一个小时！</span></span><br><span class="line">git config --global user.name "panruipr"</span><br><span class="line">git config --global user.email "xxxx@qq.com"</span><br><span class="line"><span class="meta">   #</span><span class="bash">配置git邮件和用户名用来上传代码的时候，不配置会报错  你是谁？</span></span><br><span class="line">hexo d 上传代码</span><br><span class="line">hexo d -g 生成并上传</span><br><span class="line">     #上传代码</span><br><span class="line">      #新建博客需要在source/_post文件目录下新建文件</span><br></pre></td></tr></table></figure><p>登录git账户，在setting中add sshkey，将密钥粘贴进去并保存<br>建立一个仓库，项目名称必须是用户名.github.io 这个之后访问博客的地址。一定不能写错<br>最后就可以访问自己的博客了，例如<a href="https://panruipr.github.io">https://panruipr.github.io</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Hexo-gitHub搭建个人博客，linux系统为centOs7&quot;&gt;&lt;a href=&quot;#Hexo-gitHub搭建个人博客，linux系统为centOs7&quot; class=&quot;headerlink&quot; title=&quot;Hexo+gitHub搭建个人博客，linux系统为
      
    
    </summary>
    
    
      <category term="Linux" scheme="https://panruipr.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>linux初始安装以及jdk，apache，mysql环境安装部署</title>
    <link href="https://panruipr.github.io/2018/06/04/Environmental%20deployment/"/>
    <id>https://panruipr.github.io/2018/06/04/Environmental deployment/</id>
    <published>2018-06-04T08:34:29.000Z</published>
    <updated>2018-11-05T01:44:04.593Z</updated>
    
    <content type="html"><![CDATA[<h2 id="linux初始安装以及jdk，apache，mysql环境安装部署"><a href="#linux初始安装以及jdk，apache，mysql环境安装部署" class="headerlink" title="linux初始安装以及jdk，apache，mysql环境安装部署"></a>linux初始安装以及jdk，apache，mysql环境安装部署</h2><h3 id="1-购买第三方云服务相关准备工作"><a href="#1-购买第三方云服务相关准备工作" class="headerlink" title="1.购买第三方云服务相关准备工作"></a>1.购买第三方云服务相关准备工作</h3><p>1.购买云服务器之后会自动创建一个实例。这里的选择是CentOS 7.2 64位操作系统的。可以根据自己的需求选择相应的操作系统和应用。<br>2.购买成功后到云主机界面重置主机密码，以方便xshell连接。<br>3.用xshell登录云服务器，创建新用户并分配相应的权限，以供学习用。<br>linux拓展命令：<br>查看用户：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">whoami #查看当前登陆用户的用户名</span><br><span class="line">who am i #表示打开当前伪装端的用户的用户名</span><br><span class="line">who mom likes #登陆人用户的详细信息</span><br><span class="line">who #命令其他常用参数</span><br></pre></td></tr></table></figure><ul><li>-a  打印能打印的全部</li><li>-d  打印死掉的进程</li><li>-m  同am i,mom likes</li><li>-q  打印当前登录用户数及用户名</li><li>-u  打印当前登录用户登录信息</li><li>-r  打印运行等级</li></ul><h3 id="2-在centos-7下新建用户名并授权常用命令"><a href="#2-在centos-7下新建用户名并授权常用命令" class="headerlink" title="2.在centos 7下新建用户名并授权常用命令"></a>2.在centos 7下新建用户名并授权常用命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">useradd 用户名 #新建用户</span><br><span class="line">groupadd 用户名 #新建组</span><br><span class="line">passwd 用户名 #修改用户密码 </span><br><span class="line">userdel -r 用户名 #删除用户以及相关的文件</span><br></pre></td></tr></table></figure><h3 id="3-设置防火墙"><a href="#3-设置防火墙" class="headerlink" title="3.设置防火墙"></a>3.设置防火墙</h3><p>因为22端口太容易被扫描到了，对于服务器来说不太安全。那就需要关闭22端口开放新的端口号作为ssh服务的端口<br>相关命令:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">systemctl status firewalld.service  #查看防火墙状态</span><br><span class="line">systemctl status sshd.service #查看ssh状态</span><br><span class="line">systemctl stop/start/restart firewalld.service #关闭，开启，重启防火墙</span><br><span class="line">systemctl stop/start/restart sshd.service #关闭，开启，重启sshd服务</span><br><span class="line">firewalld-cmd --permanent --zone=public --add-port=57482/tcp #添加端口号</span><br><span class="line">firewalld-cmd --permanent --zone=public --remove-port=57482/tcp #删除端口号</span><br><span class="line">firewalld-cmd --list-all #查看端口列表</span><br><span class="line"></span><br><span class="line">cd /etc/ssh/sshd.config #找到 #Port=22 默认端口为22，所以不管注释还是不注释都没用。在下面一行新增Port=57482</span><br><span class="line"><span class="meta">#</span>在centos7 里装辅助工具semanage yum provides semanage 主意装semanage需要安装其依赖工具包 </span><br><span class="line">yum install policycoreutils-python tab #自动补全</span><br><span class="line">semanage port -l | grep ssh #查询当前ssh的端口号 </span><br><span class="line">semanage port -a -t ssh_port_t -p tcp 57482 #查询当前ssh的端口号,之后查看一遍端口是否设置成功 </span><br><span class="line">systemctl restart sshd.service #重启sshd.service服务  </span><br><span class="line">firewalld-cmd --permanent --zone=public --add-port=57482/tcp #在防火墙中新增端口 并重启</span><br></pre></td></tr></table></figure><p>注意 如果是第三方服务器可以在安全组中自定义安全规则来阻止来自22端口的访问。</p><p>开启防火墙关闭22端口配置只允许57482的端口之后ping不通了。。。,这个时候开放80端口在，在安全组中允许所有端口访问就可以ping通，不知道为什么只允许80端口通过并不能ping通</p><h3 id="4-安装jdk1-8"><a href="#4-安装jdk1-8" class="headerlink" title="4.安装jdk1.8"></a>4.安装jdk1.8</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>一般jdk安装在/usr/local目录下。将文件解压到此目录下pwd一下获取路径</span><br><span class="line">wget --no-check-certificate --no-cookies --header "Cookie: oraclelicense=accept-securebackup-cookie" http://download.oracle.com/otn-pub/java/jdk/8u91-b14/jdk-8u91-linux-x64.tar.gz</span><br><span class="line">cd /etc/profile #去文件中末尾配置java_home和jre_home简称环境变量，配置如下</span><br><span class="line">JAVA_HOME=/usr/local/java/jdk1.8.0_171</span><br><span class="line">JRE_HOME=$JAVA_HOME/jre</span><br><span class="line">PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin</span><br><span class="line">CLASS_PATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib</span><br><span class="line">export JAVA_HOME JRE_HOME CLASS_PATH PATH</span><br><span class="line">source /etc/profile #启用新的配置</span><br><span class="line">java -version #查看是否安装成功  出现版本信息就代表安装成功。</span><br></pre></td></tr></table></figure><h3 id="5-配置tomcat"><a href="#5-配置tomcat" class="headerlink" title="5.配置tomcat"></a>5.配置tomcat</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>下载tomcat7到目标文件</span><br><span class="line">cd tomcat7/bin  #修改catalina,sh添加配置，在此之前保证jdk已经成功安装</span><br><span class="line">JAVA_OPTS="-Xms512m -Xmx1024m -Xss1024K -XX:PermSize=512m -XX:MaxPermSize=1024m"</span><br><span class="line">export TOMCAT_HOME=/home/panrui/tomcat7</span><br><span class="line">export CATALINA_HOME=/home/panrui/tomcat7</span><br><span class="line">export JRE_HOME=/usr/local/java/jdk1.8.0_171/jre</span><br><span class="line">export JAVA_HOME=/usr/local/java/jdk1.8.0_171</span><br><span class="line">cd tomcat/conf #修改下的server.xml里的端口保证对外端口已经添加到防火墙中</span><br><span class="line">/start.sh #修改第三方服务器安全组规则将新端口添加到允许访问的规则中 启动服务器</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;linux初始安装以及jdk，apache，mysql环境安装部署&quot;&gt;&lt;a href=&quot;#linux初始安装以及jdk，apache，mysql环境安装部署&quot; class=&quot;headerlink&quot; title=&quot;linux初始安装以及jdk，apache，mysq
      
    
    </summary>
    
    
      <category term="Linux" scheme="https://panruipr.github.io/tags/Linux/"/>
    
      <category term="云服务" scheme="https://panruipr.github.io/tags/%E4%BA%91%E6%9C%8D%E5%8A%A1/"/>
    
  </entry>
  
</feed>
